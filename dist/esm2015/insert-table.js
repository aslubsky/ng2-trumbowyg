export class TrumbowygInsertTablePlugin {
    static init(editor, lang) {
        TrumbowygInsertTablePlugin.editor = editor;
        editor.plugins.insertTable = {
            init: function (trumbowyg) {
                // console.log('trumbowyg', trumbowyg);
                trumbowyg.o.plugins.insertTable = trumbowyg.o.plugins.insertTable || {};
                trumbowyg.addBtnDef('insertTable', {
                    dropdown: TrumbowygInsertTablePlugin.buildDropdown('insertTable', trumbowyg),
                    tag: 'table'
                });
                setTimeout(function () {
                    var i = 1;
                    var j = 1;
                    for (; i <= 10; i++) {
                        for (j = 1; j <= 10; j++) {
                            TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j] = trumbowyg.$box.find('.trumbowyg-insertTable_r' + i + '_c' + j + '_insertTable-dropdown-button');
                        }
                    }
                    trumbowyg.$box.find('.trumbowyg-insertTable-button')
                        .off('click')
                        .on('click', function () {
                        jQuery('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button').removeClass('active');
                    });
                    trumbowyg.$box.find('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button')
                        .off('mouseenter mouseleave')
                        // .on('hover', (e: any) => {
                        .hover((e) => {
                        //console.log(e.target.classList);
                        //$(e.target).attr('class').split('_')
                        var tmp = jQuery(e.target).attr('class').split('_');
                        var r = parseInt(tmp[1].replace('r', ''), 10);
                        var c = parseInt(tmp[2].replace('c', ''), 10);
                        // console.log('i', tmp, r, c);
                        TrumbowygInsertTablePlugin.fillCells(r, c);
                        //console.log($(e.target).attr('class').split('_'));
                    }, (e) => {
                        // console.log(e);
                        var tmp = jQuery(e.target).attr('class').split('_');
                        var r = parseInt(tmp[1].replace('r', ''), 10);
                        var c = parseInt(tmp[2].replace('c', ''), 10);
                        // console.log('o', tmp, r, c);
                        TrumbowygInsertTablePlugin.fillCells(r, c);
                    });
                }, 1000);
            },
            //tagHandler: colorTagHandler
        };
    }
    static buildTable(r, c) {
        var html = [];
        html.push('<table border="1" width="100%">');
        var i = 1;
        var j = 1;
        for (; i <= r; i++) {
            html.push('<tr>');
            for (j = 1; j <= c; j++) {
                html.push('<td>&nbsp;</td>');
            }
            html.push('</tr>');
        }
        html.push('</table>');
        return html;
    }
    static fillCells(r, c) {
        jQuery('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button').removeClass('active');
        var i = 1;
        var j = 1;
        for (; i <= r; i++) {
            for (j = 1; j <= c; j++) {
                // console.log(TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j]);
                TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j].addClass('active');
            }
        }
    }
    static buildDropdown(func, trumbowyg) {
        var dropdown = [];
        var i = 1;
        var j = 1;
        for (; i <= 10; i++) {
            for (j = 1; j <= 10; j++) {
                var btn = 'insertTable_r' + i + '_c' + j + '_' + func;
                // trumbowyg.addBtnDef()
                // console.log('trumbowyg', trumbowyg);
                trumbowyg.addBtnDef(btn, {
                    forceCss: true,
                    fn: function (params) {
                        var html = TrumbowygInsertTablePlugin.buildTable(params.r, params.c).join('');
                        // console.info('HTML', params, t, buildTable(params.r, params.c).join(''), html);
                        trumbowyg.restoreRange();
                        trumbowyg.syncCode();
                        TrumbowygInsertTablePlugin.editor.insertHtml(trumbowyg, html);
                    },
                    text: ' ',
                    param: {
                        r: i,
                        c: j
                    }
                });
                dropdown.push(btn);
            }
        }
        return dropdown;
    }
}
TrumbowygInsertTablePlugin.elementsCache = {};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5zZXJ0LXRhYmxlLmpzIiwic291cmNlUm9vdCI6Ii9ob21lL2FzbHVic2t5L3dvcmsvY29sbGFib3JhdG9yL25nMi10cnVtYm93eWcvc3JjLyIsInNvdXJjZXMiOlsiaW5zZXJ0LXRhYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sT0FBTywwQkFBMEI7SUFLNUIsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFXLEVBQUUsSUFBWTtRQUN4QywwQkFBMEIsQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBRTNDLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxHQUFHO1lBQ3pCLElBQUksRUFBRSxVQUFVLFNBQWM7Z0JBQzFCLHVDQUF1QztnQkFDdkMsU0FBUyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsSUFBSSxFQUFFLENBQUM7Z0JBQ3hFLFNBQVMsQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFO29CQUMvQixRQUFRLEVBQUUsMEJBQTBCLENBQUMsYUFBYSxDQUFDLGFBQWEsRUFBRSxTQUFTLENBQUM7b0JBQzVFLEdBQUcsRUFBRSxPQUFPO2lCQUNmLENBQUMsQ0FBQztnQkFFSCxVQUFVLENBQUM7b0JBQ1AsSUFBSSxDQUFDLEdBQVcsQ0FBQyxDQUFDO29CQUNsQixJQUFJLENBQUMsR0FBVyxDQUFDLENBQUM7b0JBQ2xCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRTt3QkFDakIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUU7NEJBQ3RCLDBCQUEwQixDQUFDLGFBQWEsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQywwQkFBMEIsR0FBRyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMs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LENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7d0JBQzlFLGtGQUFrRjt3QkFFbEYsU0FBUyxDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUN6QixTQUFTLENBQUMsUUFBUSxFQUFFLENBQUM7d0JBRXJCLDBCQUEwQixDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUNsRSxDQUFDO29CQUNELElBQUksRUFBRSxHQUFHO29CQUNULEtBQUssRUFBRTt3QkFDSCxDQUFDLEVBQUUsQ0FBQzt3QkFDSixDQUFDLEVBQUUsQ0FBQztxQkFDUDtpQkFDSixDQUFDLENBQUM7Z0JBQ0gsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUN0QjtTQUNKO1FBRUQsT0FBTyxRQUFRLENBQUM7SUFDcEIsQ0FBQzs7QUF0SGEsd0NBQWEsR0FBUSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJkZWNsYXJlIHZhciBqUXVlcnk6IGFueTtcblxuZXhwb3J0IGNsYXNzIFRydW1ib3d5Z0luc2VydFRhYmxlUGx1Z2luIHtcbiAgICBwdWJsaWMgc3RhdGljIGVkaXRvcjogYW55O1xuXG4gICAgcHVibGljIHN0YXRpYyBlbGVtZW50c0NhY2hlOiBhbnkgPSB7fTtcblxuICAgIHB1YmxpYyBzdGF0aWMgaW5pdChlZGl0b3I6IGFueSwgbGFuZzogc3RyaW5nKSB7XG4gICAgICAgIFRydW1ib3d5Z0luc2VydFRhYmxlUGx1Z2luLmVkaXRvciA9IGVkaXRvcjtcblxuICAgICAgICBlZGl0b3IucGx1Z2lucy5pbnNlcnRUYWJsZSA9IHtcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICh0cnVtYm93eWc6IGFueSkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd0cnVtYm93eWcnLCB0cnVtYm93eWcpO1xuICAgICAgICAgICAgICAgIHRydW1ib3d5Zy5vLnBsdWdpbnMuaW5zZXJ0VGFibGUgPSB0cnVtYm93eWcuby5wbHVnaW5zLmluc2VydFRhYmxlIHx8IHt9O1xuICAgICAgICAgICAgICAgIHRydW1ib3d5Zy5hZGRCdG5EZWYoJ2luc2VydFRhYmxlJywge1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bjogVHJ1bWJvd3lnSW5zZXJ0VGFibGVQbHVnaW4uYnVpbGREcm9wZG93bignaW5zZXJ0VGFibGUnLCB0cnVtYm93eWcpLFxuICAgICAgICAgICAgICAgICAgICB0YWc6ICd0YWJsZSdcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaTogbnVtYmVyID0gMTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGo6IG51bWJlciA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDE7IGogPD0gMTA7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRydW1ib3d5Z0luc2VydFRhYmxlUGx1Z2luLmVsZW1lbnRzQ2FjaGVbJ3InICsgaSArICdfYycgKyBqXSA9IHRydW1ib3d5Zy4kYm94LmZpbmQoJy50cnVtYm93eWctaW5zZXJ0VGFibGVfcicgKyBpICsgJ19jJyArIGogKyAnX2luc2VydFRhYmxlLWRyb3Bkb3duLWJ1dHRvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdHJ1bWJvd3lnLiRib3guZmluZCgnLnRydW1ib3d5Zy1pbnNlcnRUYWJsZS1idXR0b24nKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9mZignY2xpY2snKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnkoJy50cnVtYm93eWctZHJvcGRvd24taW5zZXJ0VGFibGUudHJ1bWJvd3lnLWRyb3Bkb3duIGJ1dHRvbicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHRydW1ib3d5Zy4kYm94LmZpbmQoJy50cnVtYm93eWctZHJvcGRvd24taW5zZXJ0VGFibGUudHJ1bWJvd3lnLWRyb3Bkb3duIGJ1dHRvbicpXG4gICAgICAgICAgICAgICAgICAgICAgICAub2ZmKCdtb3VzZWVudGVyIG1vdXNlbGVhdmUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLm9uKCdob3ZlcicsIChlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC5ob3ZlcigoZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhlLnRhcmdldC5jbGFzc0xpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJChlLnRhcmdldCkuYXR0cignY2xhc3MnKS5zcGxpdCgnXycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IGpRdWVyeShlLnRhcmdldCkuYXR0cignY2xhc3MnKS5zcGxpdCgnXycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gcGFyc2VJbnQodG1wWzFdLnJlcGxhY2UoJ3InLCAnJyksIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHBhcnNlSW50KHRtcFsyXS5yZXBsYWNlKCdjJywgJycpLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2knLCB0bXAsIHIsIGMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRydW1ib3d5Z0luc2VydFRhYmxlUGx1Z2luLmZpbGxDZWxscyhyLCBjKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJChlLnRhcmdldCkuYXR0cignY2xhc3MnKS5zcGxpdCgnXycpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIChlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXAgPSBqUXVlcnkoZS50YXJnZXQpLmF0dHIoJ2NsYXNzJykuc3BsaXQoJ18nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHBhcnNlSW50KHRtcFsxXS5yZXBsYWNlKCdyJywgJycpLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBwYXJzZUludCh0bXBbMl0ucmVwbGFjZSgnYycsICcnKSwgMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdvJywgdG1wLCByLCBjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcnVtYm93eWdJbnNlcnRUYWJsZVBsdWdpbi5maWxsQ2VsbHMociwgYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL3RhZ0hhbmRsZXI6IGNvbG9yVGFnSGFuZGxlclxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgYnVpbGRUYWJsZShyOiBudW1iZXIsIGM6IG51bWJlcikge1xuICAgICAgICB2YXIgaHRtbDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgaHRtbC5wdXNoKCc8dGFibGUgYm9yZGVyPVwiMVwiIHdpZHRoPVwiMTAwJVwiPicpO1xuICAgICAgICB2YXIgaTogbnVtYmVyID0gMTtcbiAgICAgICAgdmFyIGo6IG51bWJlciA9IDE7XG4gICAgICAgIGZvciAoOyBpIDw9IHI7IGkrKykge1xuICAgICAgICAgICAgaHRtbC5wdXNoKCc8dHI+Jyk7XG4gICAgICAgICAgICBmb3IgKGogPSAxOyBqIDw9IGM7IGorKykge1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPHRkPiZuYnNwOzwvdGQ+Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBodG1sLnB1c2goJzwvdHI+Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaHRtbC5wdXNoKCc8L3RhYmxlPicpO1xuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBmaWxsQ2VsbHMocjogbnVtYmVyLCBjOiBudW1iZXIpIHtcbiAgICAgICAgalF1ZXJ5KCcudHJ1bWJvd3lnLWRyb3Bkb3duLWluc2VydFRhYmxlLnRydW1ib3d5Zy1kcm9wZG93biBidXR0b24nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgdmFyIGk6IG51bWJlciA9IDE7XG4gICAgICAgIHZhciBqOiBudW1iZXIgPSAxO1xuICAgICAgICBmb3IgKDsgaSA8PSByOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoaiA9IDE7IGogPD0gYzsgaisrKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coVHJ1bWJvd3lnSW5zZXJ0VGFibGVQbHVnaW4uZWxlbWVudHNDYWNoZVsncicgKyBpICsgJ19jJyArIGpdKTtcbiAgICAgICAgICAgICAgICBUcnVtYm93eWdJbnNlcnRUYWJsZVBsdWdpbi5lbGVtZW50c0NhY2hlWydyJyArIGkgKyAnX2MnICsgal0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgYnVpbGREcm9wZG93bihmdW5jOiBhbnksIHRydW1ib3d5ZzogYW55KSB7XG4gICAgICAgIHZhciBkcm9wZG93bjogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICB2YXIgaTogbnVtYmVyID0gMTtcbiAgICAgICAgdmFyIGo6IG51bWJlciA9IDE7XG4gICAgICAgIGZvciAoOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoaiA9IDE7IGogPD0gMTA7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBidG46IHN0cmluZyA9ICdpbnNlcnRUYWJsZV9yJyArIGkgKyAnX2MnICsgaiArICdfJyArIGZ1bmM7XG4gICAgICAgICAgICAgICAgLy8gdHJ1bWJvd3lnLmFkZEJ0bkRlZigpXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3RydW1ib3d5ZycsIHRydW1ib3d5Zyk7XG4gICAgICAgICAgICAgICAgdHJ1bWJvd3lnLmFkZEJ0bkRlZihidG4sIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yY2VDc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAocGFyYW1zOiBhbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gVHJ1bWJvd3lnSW5zZXJ0VGFibGVQbHVnaW4uYnVpbGRUYWJsZShwYXJhbXMuciwgcGFyYW1zLmMpLmpvaW4oJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5pbmZvKCdIVE1MJywgcGFyYW1zLCB0LCBidWlsZFRhYmxlKHBhcmFtcy5yLCBwYXJhbXMuYykuam9pbignJyksIGh0bWwpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVtYm93eWcucmVzdG9yZVJhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVtYm93eWcuc3luY0NvZGUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgVHJ1bWJvd3lnSW5zZXJ0VGFibGVQbHVnaW4uZWRpdG9yLmluc2VydEh0bWwodHJ1bWJvd3lnLCBodG1sKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJyAnLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbToge1xuICAgICAgICAgICAgICAgICAgICAgICAgcjogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGM6IGpcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnB1c2goYnRuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkcm9wZG93bjtcbiAgICB9XG59XG4iXX0=