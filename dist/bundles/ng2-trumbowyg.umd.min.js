!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("@angular/forms"),require("rxjs/add/operator/toPromise")):"function"==typeof define&&define.amd?define("ng2-trumbowyg",["exports","@angular/core","@angular/common/http","@angular/forms","rxjs/add/operator/toPromise"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ng2-trumbowyg"]={},e.ng.core,e.ng.common.http,e.ng.forms)}(this,(function(e,t,n,i){"use strict";var a=function(){function e(){}return e.init=function(t,n,i){e.editor=t,t.plugins.tidy={init:function(t){t.toggle=function(){var n=t.o.prefix;t.semanticCode(!1,!0),setTimeout((function(){t.doc.activeElement.blur(),t.$box.toggleClass(n+"editor-hidden "+n+"editor-visible"),t.$btnPane.toggleClass(n+"disable"),t.$btnPane.find("."+n+"viewHTML-button").toggleClass(n+"active"),t.$box.hasClass(n+"editor-visible")?t.$ta.attr("tabindex",-1):(e.editor.tidyUrl&&i.post(e.editor.tidyUrl,t.$ed.html(),{responseType:"text"}).toPromise().then((function(e){t.$ta.val(e)})),t.$ta.removeAttr("tabindex"))}),0)}}}},e}(),s=function(){function e(){}return e.init=function(t,n){e.editor=t,e.fontSizes=[];for(var i=1;i<=7;i++)e.fontSizes.push(t.langs[n]["fontSize"+i]);t.plugins.fontSize={init:function(t){t.addBtnDef("fontSize",{dropdown:e.buildDropdown("fontSize",t)})}}},e.buildDropdown=function(t,n){var i=[];return e.fontSizes.forEach((function(e,a){var s=t+"_"+a;n.addBtnDef(s,{fn:function(e,t){document.execCommand("fontSize",!1,e),t.syncCode()},text:e,param:a+1}),i.push(s)})),i},e}();s.fontSizes=[];var o=function(){function e(){}return e.init=function(t,n){e.editor=t,e.fonts=["Arial","Courier","Courier New","Georgia","Helvetica","Impact","Monospace","Sans-serif","Serif","Tahoma","Times New Roman","Trebuchet MS","Verdana"],t.plugins.fontName={init:function(t){t.o.plugins.fontName=t.o.plugins.fontName||{},t.addBtnDef("fontName",{dropdown:e.buildDropdown("fontName",t)})}}},e.buildDropdown=function(t,n){var i=[];return e.fonts.forEach((function(e,a){var s=e.toLowerCase().replace(" ","").replace("-",""),o=t+"_"+s;n.addBtnDef(o,{fn:function(e,t){document.execCommand("fontName",!1,e),t.syncCode()},text:e,param:e}),i.push(o)})),i},e}(),r=function(){function e(){}return e.init=function(t,n){e.editor=t,e.lang=n,t.plugins.selectStyles={init:function(t){t.o.plugins.selectStyles=t.o.plugins.selectStyles||{},t.addBtnDef("selectStyles",{fn:function(n){e.selectStylesCb(n,t)}})},tag:"img"}},e.selectStylesCb=function(t,n){n.o.prefix;var i=[];i.push('<div class="modal-container styles-select">'),i.push('   <ul class="styles-list template-gallery list-unstyled">'),e.allStyles.forEach((function(e){i.push('   <li title="'+e.description+'" class="item style"><label><img src="'+e.icon+'" class="select-template-icon"><input type="radio" value="'+e.id+'" name="template"><span class="title"> '+e.title+"</span></label></li>")})),i.push("   </ul>"),i.push("</div>");var a=n.openModal(e.editor.langs[e.lang].selectTemplatesStyle,i.join("")).on("tbwconfirm",(function(){var e=jQuery("input:checked",a);if(e.length>0){var t=parseInt(e.val(),10),i=a.parent().find(".trumbowyg-editor");i.find(".customStyle").remove(),i.append('<style class="customStyle">@import url(https://ets.davintoo.com/uploads/css/'+t+".css);</style>"),n.syncTextarea(),n.$c.trigger("tbwchange")}setTimeout((function(){n.closeModal()}),250)})).on("tbwcancel",(function(){n.restoreRange(),n.closeModal()}));a.addClass("big"),jQuery(".styles-list li label",a).off("click").on("click",(function(e){jQuery(".styles-list li",a).removeClass("active"),jQuery(this).parent().addClass("active")}))},e.setStyles=function(t){e.allStyles=t},e}();r.allStyles=[];var l=function(){function e(){}return e.init=function(t,n){e.editor=t,t.plugins.lead={init:function(e){e.addBtnDef("lead",{fn:function(){var t=e.doc.getSelection();if(t.rangeCount){var n=t.getRangeAt(0).cloneRange();n.surroundContents(jQuery('<p class="lead"/>').get(0)),t.removeAllRanges(),t.addRange(n)}e.syncCode(),e.updateButtonPaneStatus(),e.$c.trigger("tbwchange")}}),e.btnsDef.formatting.dropdown=["p","blockquote","lead","h1","h2","h3","h4"]}}},e}(),u=function(){function e(){}return e.init=function(t,n){e.editor=t,t.plugins.insertMediaEmbed={init:function(t){t.o.plugins.insertMediaEmbed=t.o.plugins.insertMediaEmbed||{},t.addBtnDef("insertMediaEmbed",{fn:function(n,i){i=t;var a=[];a.push('<div class="modal-container">'),a.push('<div class="modal-meadia-embed">'),a.push("<textarea></textarea>"),a.push("</div>"),a.push("</div>"),console.log("insertMediaEmbed");var s=i.openModal("Embed Code",a.join("")).on("tbwconfirm",(function(){i.restoreRange(),i.syncCode();var t=jQuery("textarea",s).val();t&&e.editor.insertHtml(i,t),setTimeout((function(){i.closeModal()}),250)})).on("tbwcancel",(function(){i.restoreRange(),i.closeModal()}))}})}}},e}(),c=function(){function e(){}return e.init=function(t,n){e.editor=t,t.plugins.insertTable={init:function(t){t.o.plugins.insertTable=t.o.plugins.insertTable||{},t.addBtnDef("insertTable",{dropdown:e.buildDropdown("insertTable",t),tag:"table"}),setTimeout((function(){for(var n=1,i=1;n<=10;n++)for(i=1;i<=10;i++)e.elementsCache["r"+n+"_c"+i]=t.$box.find(".trumbowyg-insertTable_r"+n+"_c"+i+"_insertTable-dropdown-button");t.$box.find(".trumbowyg-insertTable-button").off("click").on("click",(function(){jQuery(".trumbowyg-dropdown-insertTable.trumbowyg-dropdown button").removeClass("active")})),t.$box.find(".trumbowyg-dropdown-insertTable.trumbowyg-dropdown button").off("mouseenter mouseleave").hover((function(t){var n=jQuery(t.target).attr("class").split("_"),i=parseInt(n[1].replace("r",""),10),a=parseInt(n[2].replace("c",""),10);e.fillCells(i,a)}),(function(t){var n=jQuery(t.target).attr("class").split("_"),i=parseInt(n[1].replace("r",""),10),a=parseInt(n[2].replace("c",""),10);e.fillCells(i,a)}))}),1e3)}}},e.buildTable=function(e,t){var n=[];n.push('<table border="1" width="100%">');for(var i=1,a=1;i<=e;i++){for(n.push("<tr>"),a=1;a<=t;a++)n.push("<td>&nbsp;</td>");n.push("</tr>")}return n.push("</table>"),n},e.fillCells=function(t,n){jQuery(".trumbowyg-dropdown-insertTable.trumbowyg-dropdown button").removeClass("active");for(var i=1,a=1;i<=t;i++)for(a=1;a<=n;a++)e.elementsCache["r"+i+"_c"+a].addClass("active")},e.buildDropdown=function(t,n){for(var i=[],a=1,s=1;a<=10;a++)for(s=1;s<=10;s++){var o="insertTable_r"+a+"_c"+s+"_"+t;n.addBtnDef(o,{forceCss:!0,fn:function(t){var i=e.buildTable(t.r,t.c).join("");n.restoreRange(),n.syncCode(),e.editor.insertHtml(n,i)},text:" ",param:{r:a,c:s}}),i.push(o)}return i},e}();c.elementsCache={};var d=function(){function e(){}return e.init=function(t,n){e.editor=t,e.lang=n,t.plugins.selectImage={init:function(t){t.o.plugins.selectImage=t.o.plugins.selectImage||{},t.addBtnDef("selectImage",{fn:function(n){e.selectImageCb(n,t,e.editorImages)}})},tag:"img"}},e.selectImageCb=function(t,n,i){var a=n.o.prefix,s=0,o=i.length;if(0!=o){var r=[];for(r.push('<div class="modal-container">'),r.push('<ul class="'+a+'select-images gallery">');s<o;s++)r.push('<li class="item" data-i="'+s+'"><label><img width="50px" src="'+i[s].url+'"/></label></li>');r.push("</ul>"),r.push("</div>");var l=null,u=n.openModal(e.editor.langs[e.lang].attachedImages,r.join("")).on("tbwconfirm",(function(){if(n.restoreRange(),n.syncCode(),null!=l){var e=i[l].width||1024;n.execCmd("insertImage",i[l].url),e>1024&&jQuery('img[src="'+i[l].url+'"]:not([alt])',n.$box).attr("width","1024px")}setTimeout((function(){n.closeModal()}),250)})).on("tbwcancel",(function(){n.restoreRange(),n.closeModal()}));jQuery("li.item",u).on("click",(function(){jQuery("li",u).removeClass("active"),jQuery(this).addClass("active"),l=jQuery(this).data("i")}))}},e.updateImages=function(t){e.editorImages=[],t.forEach((function(t){if(t.extension=t.extension||t.url.split(".").pop(),-1!=e.imagesExtensions.indexOf(t.extension)){if(!t.width){var n=new Image;n.setAttribute("data-i",e.editorImages.length+""),n.onload=function(t){if("error"!==t.type&&this.width){var n=parseInt(this.getAttribute("data-i"));e.editorImages[n].width=this.width}},n.src=t.url,t.width=1024}e.editorImages.push(t)}}))},e}();d.editorImages=[],d.imagesExtensions=["jpg","png","jpeg","bmp","gif","svg"];var m=function(){function e(){}return e.init=function(t,n){e.editor=t,e.lang=n,t.plugins.selectResources={init:function(t){t.o.plugins.selectResources=t.o.plugins.selectResources||{},t.addBtnDef("selectResources",{fn:function(n){e.selectResourcesCb(n,t)}})},tag:"img"}},e.translate=function(t){return e.editor.langs[e.lang][t]},e.renderList=function(e,t,n){n.forEach((function(n){t.push('<li class="item">'),t.push("<label>"),t.push('<input type="radio" name="r'+e+'" data-id="'+n.id+'" title="'+n.title+'" data-type="'+n.display_type+'" value="'+n.id+'"/>'),t.push("<strong>"+n.title+"</strong>"),n.description&&n.description.length>0&&t.push("<br/><i>"+n.description+"</i>"),t.push("</label>"),t.push("</li>")}))},e.selectResourcesCb=function(t,n){var i=e.pfx=n.o.prefix,a=[];a.push('<div class="resources-select modal-container">'),a.push('<div class="resources-search cbr-input-control">'),a.push('<label for="text" class="cbr-label">'+e.translate("selectResourcesSearch")+"</label>"),a.push('<input class="cbr-input cbr-input-default cbr-input-email" type="text">'),a.push('<span class="cbr-icon-input cbr-icon-input-primary">'),a.push('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'),a.push('width="20" height="20" viewBox="0 0 451 451" style="enable-background:new 0 0 451 451;" xml:space="preserve">'),a.push("<g>"),a.push('<path d="M447.05,428l-109.6-109.6c29.4-33.8,47.2-77.9,47.2-126.1C384.65,86.2,298.35,0,192.35,0C86.25,0,0.05,86.3,0.05,192.3'),a.push("s86.3,192.3,192.3,192.3c48.2,0,92.3-17.8,126.1-47.2L428.05,447c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4"),a.push("C452.25,441.8,452.25,433.2,447.05,428z M26.95,192.3c0-91.2,74.2-165.3,165.3-165.3c91.2,0,165.3,74.2,165.3,165.3"),a.push('s-74.1,165.4-165.3,165.4C101.15,357.7,26.95,283.5,26.95,192.3z"/>'),a.push("</g>"),a.push("</svg>"),a.push("</span>"),a.push("</div>"),a.push('<ul class="cbr2-tabs" role="tablist">'),a.push('<li role="all" class="cbr2-tabs-itemactive">'),a.push('   <a data-type="all"  role="tab">'+e.translate("selectResourcesAll")+"</a>"),a.push("</li>"),a.push('<li role="gallery" class="cbr2-tabs-item">'),a.push('   <a data-type="gallery" role="tab">'+e.translate("selectResourcesGallery")+"</a>"),a.push("</li>"),a.push('<li role="html" class="cbr2-tabs-item">'),a.push('   <a data-type="html" role="tab">'+e.translate("selectResourcesHtmlSite")+"</a>"),a.push("</li>"),a.push('<li role="video" class="cbr2-tabs-item">'),a.push('   <a data-type="video" role="tab">'+e.translate("selectResourcesVideo")+"</a>"),a.push("</li>"),a.push('<li role="audio" class="cbr2-tabs-item">'),a.push('   <a data-type="audio" role="tab">'+e.translate("selectResourcesAudio")+"</a>"),a.push("</li>"),a.push("</ul>"),a.push('<div class="cbr-tab-content">'),a.push('   <div role="tabpanel" class="cbr-tab-pane active">'),a.push('   <ul class="resources-list list-unstyled">'),e.renderList(i,a,e.editorResources),a.push("   </ul>"),a.push("</div>"),a.push("</div>"),a.push("</div>");var s=e.$modal=n.openModal(e.translate("selectResourcesHeader"),a.join("")).on("tbwconfirm",(function(){var t=jQuery("input:checked",s);console.log("selected",t);var i=t.val(),a=t.data("type");if(n.restoreRange(),n.syncCode(),i)switch("mp4"===a&&(a="video"),"mp3"!==a&&"acc"!==a||(a="audio"),a){case"gallery":e.editor.insertHtml(n,'<iframe resource-in-resource-iframe="" allowfullscreen width="100%" height="640px" frameborder="0" src="/node_modules/collaborator-gallery/dist/index.html?id='+i+'" data-item-id="'+i+'" scrolling="no" marginheight="0" class="no-border embed-responsive-item"></iframe>');break;case"video":e.editor.insertHtml(n,'<iframe resource-in-resource-iframe="" allowfullscreen width="100%" height="480px" frameborder="0" src="/node_modules/collaborator-video-player/dist/index.html?id='+i+'" data-item-id="'+i+'" scrolling="no" marginheight="0" class="no-border embed-responsive-item"></iframe>');break;case"audio":e.editor.insertHtml(n,'<iframe resource-in-resource-iframe="" allowfullscreen width="100%" height="65px" frameborder="0" src="/node_modules/collaborator-audio-player/dist/index.html?id='+i+'" data-item-id="'+i+'" scrolling="no" marginheight="0" class="no-border embed-responsive-item"></iframe>');break;case"html":e.editor.insertHtml(n,'<iframe resource-in-resource-iframe="" allowfullscreen width="100%" height="640px" frameborder="0" src="/node_modules/collaborator-html-player/dist/index.html?id='+i+'" scrolling="no" marginheight="0" data-item-id="'+i+'" class="no-border embed-responsive-item"></iframe>')}setTimeout((function(){n.closeModal()}),250)})).on("tbwcancel",(function(){n.restoreRange(),n.closeModal()}));jQuery(".cbr2-tabs a",s).off("click").on("click",(function(t){t.preventDefault(),jQuery(".cbr2-tabs-item",s).removeClass("cbr-tabs-active"),jQuery(this).parent().addClass("cbr-tabs-active"),e.onSearch.emit({type:jQuery(this).attr("data-type")||"all",title:jQuery(".cbr-input",s).val()})})),jQuery(".cbr-icon-input",s).off("click").on("click",(function(){e.onSearch.emit({type:jQuery(this).attr("data-type")||"all",title:jQuery(".cbr-input",s).val()})}))},e.updateResources=function(t){e.editorResources=t,jQuery(".resources-list",e.$modal).empty();var n=[];e.renderList(e.pfx,n,t),jQuery(".resources-list",e.$modal).append(n.join(""))},e}();m.editorResources=[],m.onSearch=new t.EventEmitter;var p=function(){function e(){}return e.init=function(t,n){e.editor=t,e.lang=n,t.plugins.selectTemplates={init:function(t){t.o.plugins.selectTemplates=t.o.plugins.selectTemplates||{},t.addBtnDef("selectTemplates",{fn:function(n){e.selectTemplatesCb(n,t)}})},tag:"img"},e.templates.push({id:"tab-no-data",label:t.langs[n].selectTemplatesNoData,elements:[]}),e.allTemplates["template-no-data"]="<div>"+t.langs[n].selectTemplatesNoData+"</div>"},e.selectTemplatesCb=function(t,n){n.o.prefix;var i=[];i.push('<div class="modal-container templates-select">'),i.push('<ul class="cbr2-tabs" role="tablist">'),e.templates.forEach((function(e,t){i.push('<li role="'+e.id+'" class="cbr2-tabs-item '+(0==t?"active":"")+'">'),i.push('   <a data-tab="'+e.id+'"  role="tab" data-toggle="tab">'+e.label+"</a>"),i.push("</li>")})),i.push("</ul>"),i.push('<div class="cbr-tab-content">'),e.templates.forEach((function(e,t){i.push('   <div role="tabpanel" id="'+e.id+'" class="cbr-tab-pane '+(0==t?"active":"")+'">'),i.push('   <ul class="templates-list template-gallery list-unstyled">'),e.elements.forEach((function(e,t){e.icon=e.icon||"themes/default/assets/img/t-icon.png",i.push('   <li title="'+e.description+'" class="item"><label><img src="'+e.icon+'" class="select-template-icon"><input type="radio" value="'+e.id+'" name="template"><span class="title"> '+e.title+'</span><span class="description"> '+e.description+"</span></label></li>")})),i.push("   </ul>"),i.push("   </div>")})),i.push("</div>"),i.push("</div>");var a=n.openModal(e.editor.langs[e.lang].selectTemplatesHeader,i.join("")).on("tbwconfirm",(function(){var t=jQuery("input:checked",a).val();n.restoreRange(),n.syncCode(),t&&e.editor.insertHtml(n,e.allTemplates[t]),setTimeout((function(){n.closeModal()}),250)})).on("tbwcancel",(function(){n.restoreRange(),n.closeModal()}));a.addClass("big"),jQuery(".cbr2-tabs a",a).off("click").on("click",(function(e){e.preventDefault(),jQuery(".cbr2-tabs-item",a).removeClass("cbr-tabs-active"),jQuery(this).parent().addClass("cbr-tabs-active"),jQuery(".cbr-tab-content .cbr-tab-pane",a).removeClass("active"),jQuery("#"+jQuery(this).attr("data-tab")).addClass("active")})),jQuery(".template-gallery li label",a).off("click").on("click",(function(e){jQuery(".template-gallery li",a).removeClass("active"),jQuery(this).parent().addClass("active")}))},e.setTemplates=function(t,n){e.templates=t,e.allTemplates=n},e}();p.templates=[],p.allTemplates={};var f="legacy-bootstrap-styles",g=function(){function e(e,n,i){this.el=e,this.render=n,this.http=i,this.hasAutoSave=!1,this.autoSaveKey="",this.lastUpdate=0,this.addBtns=[],this._required=!1,this.base64ImageInserted=new t.EventEmitter,this.onInit=new t.EventEmitter,this._autoSaveTimer=null,this._autoSaved=null,this.propagateChange=function(e){},this._required=this.el.nativeElement.hasAttribute("required"),this._name=this.el.nativeElement.getAttribute("name")}return e.prototype.validate=function(e){return this._required?e.value&&e.value.length>0?null:{required:!0}:null},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(){},e.prototype.onChange=function(e){this._value=e,this.hasAutoSave&&this._autoSave()},e.prototype._autoSave=function(){var e=this;clearTimeout(this._autoSaveTimer),this._autoSaveTimer=setTimeout((function(){e._saveToServer()}),500)},e.prototype._saveToServer=function(){var e=new n.HttpHeaders({"Content-Type":"application/json","If-Modified-Since":"Mon, 26 Jul 1997 05:00:00 GMT","Cache-Control":"no-cache",Pragma:"no-cache"});this.http.post(a.editor.autoSaveUrl+"?action=auto-save",JSON.stringify({key:this.autoSaveKey,content:this._value}),{headers:e}).toPromise().then((function(e){}))},e.prototype._checkAutoSave=function(){var e=this;this.http.get(a.editor.autoSaveUrl+"?action=check-auto-save&key="+this.autoSaveKey).toPromise().then((function(t){e._autoSaved=t,e._autoSaved&&parseInt(e._autoSaved.date,10)>e.lastUpdate&&e._buildAutoSaveToolbar()}))},e.prototype._buildAutoSaveToolbar=function(){var t=this;this.element.data("trumbowyg").$box.append('<div class="trumbowyg-auto-save"><span class="title">'+e.langs[this.lang].hasAutoSavedMsg+'</span><span class="buttons"><button type="button" class="button-sm-default">'+e.langs[this.lang].autoSaveCancel+'</button><button type="button" class="button-sm-success">'+e.langs[this.lang].autoSaveRestore+"</button></span></div>"),setTimeout((function(){jQuery(".trumbowyg-auto-save .button-sm-default",t.element.data("trumbowyg").$box).on("click",(function(e){e.target.innerHTML="...",t.clearAutoSaved()})),jQuery(".trumbowyg-auto-save .button-sm-success",t.element.data("trumbowyg").$box).on("click",(function(e){e.target.innerHTML="...",t.restoreAutoSave(),jQuery(".trumbowyg-auto-save").hide()}))}),200)},e.prototype.clearAutoSaved=function(){var e=this;this.http.get(a.editor.autoSaveUrl+"?action=clear-auto-save&key="+this.autoSaveKey).toPromise().then((function(t){e._autoSaved=null,jQuery(".trumbowyg-auto-save").hide()}))},e.prototype.restoreAutoSave=function(){this._autoSaved&&(this._value=this._autoSaved.content,this.element.trumbowyg("html",this._value),this.propagateChange(this._value),this.lastUpdate=parseInt(this._autoSaved.date,10))},e.prototype.writeValue=function(e){null!=e&&(this._value=e,this.element.trumbowyg("html",this._value))},e.prototype.init=function(t){e.inited=!0,e.langs&&(jQuery.trumbowyg.langs=e.langs),jQuery.trumbowyg.svgPath=window.TrumbowygEditorSvgPath||"/bower_components/trumbowyg/dist/ui/icons.svg",jQuery.trumbowyg.tidyUrl="/api/rest.php/trumbowyg?action=tidy",jQuery.trumbowyg.autoSaveUrl="/api/rest.php/trumbowyg",jQuery.trumbowyg.insertHtml=function(e,t){try{try{e.doc.selection.createRange().pasteHTML(t)}catch(o){var n=document.createElement("div");n.innerHTML=t;for(var i,a=document.createDocumentFragment();i=n.firstChild;)a.appendChild(i);var s=e.doc.getSelection().getRangeAt(0);s.deleteContents(),s.insertNode(a)}}catch(n){e.execCmd("insertHTML",t)}e.syncCode(),e.$c.trigger("tbwchange")};var n={design:["bold","italic","underline","strikethrough"],semantic:["strong","em","del"],justify:["justifyLeft","justifyCenter","justifyRight","justifyFull"],lists:["unorderedList","orderedList"]};a.init(jQuery.trumbowyg,t,this.http),s.init(jQuery.trumbowyg,t),o.init(jQuery.trumbowyg,t),l.init(jQuery.trumbowyg,t),r.init(jQuery.trumbowyg,t),c.init(jQuery.trumbowyg,t),u.init(jQuery.trumbowyg,t),d.init(jQuery.trumbowyg,t),m.init(jQuery.trumbowyg,t),p.init(jQuery.trumbowyg,t),e.modes={inline:["removeformat","|",n.design,"|","fontName","fontSize","foreColor","backColor","|","insertMediaEmbed","selectImage"],simple:["removeformat","|",n.design,"|","fontName","fontSize","|",n.justify,"|",n.lists,"|","link","insertMediaEmbed","selectImage","horizontalRule","fullscreen"],noImage:["viewHTML","removeformat","|",n.design,"|","formatting","fontName","fontSize","foreColor","backColor","|",n.justify,"|",n.lists,"|","link","insertMediaEmbed","horizontalRule","fullscreen"],extend:["viewHTML","removeformat","|",n.design,"|","formatting","fontName","fontSize","foreColor","backColor","|",n.justify,"|",n.lists,"|","link","insertMediaEmbed","selectImage","selectTemplates","insertTable","horizontalRule","fullscreen"],full:["viewHTML","removeformat","|",n.design,"selectStyles","|","formatting","fontName","fontSize","foreColor","backColor","|",n.justify,"|",n.lists,"|","link","insertMediaEmbed","selectImage","selectResources","selectTemplates","insertTable","horizontalRule","fullscreen"]}},e.prototype.ngOnChanges=function(e){if(this.base64Image){var t=jQuery("<div>"+this.element.trumbowyg("html")+"</div>");t.find("#"+this.base64Image.uid).attr("src",this.base64Image.file),this.base64Image=null,this.element.trumbowyg("html",t.html())}},e.prototype.detectBase64Insert=function(t){var n=this;if(e.localImageRegexp.test(t)){var i,a=[],s=jQuery("<div>"+t+"</div>");return s.find('img[src^="data:image"]').each((function(){jQuery(this).attr("id")||(i=Math.random().toString(36).substring(2,9),jQuery(this).attr("id",i),a.push({uid:i,src:this.src}))})),this.element.trumbowyg("html",s.html()),a.forEach((function(e){n.base64ImageInserted.emit(e)})),!0}return!1},e.prototype.ngOnInit=function(){var t=this;this.lang=this.lang||"en",this.init(this.lang),this.onInit.emit(),this.mode=this.mode||"simple",this.element=jQuery(this.el.nativeElement);var n=e.modes[this.mode];this.addBtns=this.addBtns||null;var i=0;if(("extend"==this.mode||"full"==this.mode)&&!document.getElementById(f)){var a=document.createElement("LINK");this.render.setAttribute(a,"id",f),this.render.setAttribute(a,"rel","stylesheet"),this.render.setAttribute(a,"href","/node_modules/ng2-trumbowyg/assets/modified-bootstrap.css"),document.body.appendChild(a)}this.addBtns&&"extend"==this.mode&&(console.log("TrumbowygEditor addBtns",this.addBtns),this.addBtns.forEach((function(t){if("selectStyles"==t){var a=e.modes.full.indexOf(t);n.splice(a,0,t),i++}if("selectResources"==t){a=e.modes.full.indexOf(t);n.splice(a-1+i,0,t)}}))),this.element.trumbowyg("destroy"),this.element.trumbowyg({btns:n,lang:this.lang,mobile:!0,semantic:!1,autogrow:"inline"==this.mode,tablet:!0}).on("tbwpaste",(function(){var e=t.element.trumbowyg("html");t.detectBase64Insert(e)||(t.propagateChange(e),t.onChange(e))})).on("tbwchange",(function(){var e=t.element.trumbowyg("html");t.detectBase64Insert(e)||(t.propagateChange(e),t.onChange(e))})).on("tbwinit",(function(e){var n=t.element.data("trumbowyg");n&&(n.$box.addClass("trumbowyg-"+t.mode),n.$ed.addClass("page-container"),n.$ed.addClass("legacy-bootstrap"),n.$box.width()>=1200&&n.$ed.addClass("bordered"))})),setTimeout((function(){t.hasAutoSave&&t._checkAutoSave()}),500)},e.prototype.ngOnDestroy=function(){this.element.trumbowyg("destroy")},e}();g.modes={},g.langs={},g.inited=!1,g.localImageRegexp=/src\=\"data\:image\/(.*)\"/gi,g.ɵfac=function(e){return new(e||g)(t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(t.Renderer2),t.ɵɵdirectiveInject(n.HttpClient))},g.ɵdir=t.ɵɵdefineDirective({type:g,selectors:[["","trumbowyg-editor",""]],inputs:{hasAutoSave:["has-auto-save","hasAutoSave"],autoSaveKey:["auto-save-key","autoSaveKey"],lastUpdate:["last-update","lastUpdate"],addBtns:"addBtns",mode:"mode",lang:"lang",base64Image:"base64Image"},outputs:{base64ImageInserted:"base64ImageInserted"},features:[t.ɵɵProvidersFeature([{provide:i.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return g})),multi:!0},{provide:i.NG_VALIDATORS,useExisting:t.forwardRef((function(){return g})),multi:!0}]),t.ɵɵNgOnChangesFeature]});var h=function(){};h.ɵmod=t.ɵɵdefineNgModule({type:h}),h.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||h)},imports:[[n.HttpClientModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(h,{declarations:[g],imports:[n.HttpClientModule],exports:[g]}),e.TrumbowygEditor=g,e.TrumbowygEditorModule=h,e.TrumbowygFontSizePlugin=s,e.TrumbowygFontsPlugin=o,e.TrumbowygInsertLeadPlugin=l,e.TrumbowygInsertMediaEmbedPlugin=u,e.TrumbowygInsertTablePlugin=c,e.TrumbowygSelectImagesPlugin=d,e.TrumbowygSelectResourcesPlugin=m,e.TrumbowygSelectStylesPlugin=r,e.TrumbowygSelectTemplatesPlugin=p,e.TrumbowygTidyPlugin=a,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ng2-trumbowyg.umd.min.js.map