{"version":3,"sources":["../../src/tidy.ts","../../src/font-size.ts","../../src/fonts.ts","../../src/select-styles.ts","../../src/insert-lead.ts","../../src/insert-media-embed.ts","../../src/insert-table.ts","../../src/select-images.ts","../../src/select-resources.ts","../../src/select-templates.ts","../../src/editor.ts","../../src/module.ts"],"names":["TrumbowygTidyPlugin","init","editor","lang","http","plugins","tidy","t","toggle","prefix","o","semanticCode","setTimeout","doc","activeElement","blur","$box","toggleClass","$btnPane","find","hasClass","$ta","attr","tidyUrl","post","$ed","html","responseType","toPromise","then","res","val","removeAttr","TrumbowygFontSizePlugin","fontSizes","i","push","langs","fontSize","trumbowyg","addBtnDef","dropdown","buildDropdown","func","forEach","size","btn","fn","param","document","execCommand","syncCode","text","TrumbowygFontsPlugin","fonts","fontName","font","fontAlias","toLowerCase","replace","TrumbowygSelectStylesPlugin","selectStyles","params","selectStylesCb","tag","allStyles","style","description","icon","id","title","$modal","openModal","selectTemplatesStyle","join","on","selected","jQuery","length","styleId","parseInt","parent","remove","append","syncTextarea","$c","trigger","closeModal","restoreRange","addClass","off","e","removeClass","this","setStyles","TrumbowygInsertLeadPlugin","lead","documentSelection","getSelection","rangeCount","range","getRangeAt","cloneRange","surroundContents","get","removeAllRanges","addRange","updateButtonPaneStatus","btnsDef","formatting","TrumbowygInsertMediaEmbedPlugin","insertMediaEmbed","console","log","code","insertHtml","TrumbowygInsertTablePlugin","insertTable","j","elementsCache","hover","tmp","target","split","r","c","fillCells","buildTable","forceCss","TrumbowygSelectImagesPlugin","selectImage","selectImageCb","editorImages","pfx","l","url","selectedImageIndex","attachedImages","width","execCmd","data","updateImages","files","img","extension","pop","imagesExtensions","indexOf","imgObj","Image","setAttribute","onload","type","indx","getAttribute","src","TrumbowygSelectResourcesPlugin","selectResources","selectResourcesCb","translate","str","renderList","items","resource","display_type","editorResources","preventDefault","onSearch","emit","updateResources","empty","lhtml","EventEmitter","TrumbowygSelectTemplatesPlugin","selectTemplates","selectTemplatesCb","templates","label","selectTemplatesNoData","elements","allTemplates","templateSet","template","selectTemplatesHeader","setTemplates","LEGACY_BOOTSTRAP_ID","TrumbowygEditor","el","render","hasAutoSave","autoSaveKey","lastUpdate","addBtns","_required","base64ImageInserted","onInit","_autoSaveTimer","_autoSaved","propagateChange","_","nativeElement","hasAttribute","_name","prototype","validate","value","required","registerOnChange","registerOnTouched","onChange","_value","_autoSave","_this","clearTimeout","_saveToServer","headers","HttpHeaders","Content-Type","If-Modified-Since","Cache-Control","Pragma","autoSaveUrl","JSON","stringify","key","content","_checkAutoSave","date","_buildAutoSaveToolbar","element","hasAutoSavedMsg","autoSaveCancel","autoSaveRestore","innerHTML","clearAutoSaved","restoreAutoSave","hide","writeValue","inited","svgPath","window","TrumbowygEditorSvgPath","selection","createRange","pasteHTML","err","createElement","node","frag","createDocumentFragment","firstChild","appendChild","deleteContents","insertNode","btnsGrps","design","semantic","justify","lists","modes","inline","simple","noImage","extend","full","ngOnChanges","changes","base64Image","uid","file","detectBase64Insert","localImageRegexp","test","images","each","Math","random","toString","substring","image","ngOnInit","mode","tmpBtns","addElement","getElementById","linkContainer","body","elemIndex","splice","btns","mobile","autogrow","tablet","ngOnDestroy","i0__namespace","ɵɵdirectiveInject","ElementRef","Renderer2","i1__namespace","HttpClient","selectors","inputs","outputs","features","ɵɵProvidersFeature","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","NG_VALIDATORS","ɵɵNgOnChangesFeature","Directive","selector","providers","Input","Output","TrumbowygEditorModule","HttpClientModule","NgModule","imports","declarations","exports"],"mappings":"k0BAGA,SAAAA,YAGkBA,EAAAC,KAAP,SAAYC,EAAaC,EAAcC,GAC1CJ,EAAoBE,OAASA,EAE7BA,EAAOG,QAAQC,KAAO,CAClBL,KAAM,SAACM,GAGHA,EAAEC,OAAS,WACP,IAAIC,EAASF,EAAEG,EAAED,OACjBF,EAAEI,cAAa,GAAO,GACtBC,YAAW,WACPL,EAAEM,IAAIC,cAAcC,OACpBR,EAAES,KAAKC,YAAYR,EAAS,iBAAmBA,EAAS,kBACxDF,EAAEW,SAASD,YAAYR,EAAS,WAChCF,EAAEW,SAASC,KAAK,IAAMV,EAAS,mBAAmBQ,YAAYR,EAAS,UACnEF,EAAES,KAAKI,SAASX,EAAS,kBACzBF,EAAEc,IAAIC,KAAK,YAAa,IAEpBtB,EAAoBE,OAAOqB,SAE3BnB,EAAKoB,KACDxB,EAAoBE,OAAOqB,QAC3BhB,EAAEkB,IAAIC,OAAQ,CACVC,aAAc,SAEjBC,YACAC,MAAK,SAACC,GAEHvB,EAAEc,IAAIU,IAAID,MAGtBvB,EAAEc,IAAIW,WAAW,eAEtB,yBCrCvB,SAAAC,YAIkBA,EAAAhC,KAAP,SAAYC,EAAaC,GAC5B8B,EAAwB/B,OAASA,EAEjC+B,EAAwBC,UAAY,GAGpC,IADA,IAAIC,EAAI,EACDA,GAAK,EAAGA,IAEXF,EAAwBC,UAAUE,KAAKlC,EAAOmC,MAAMlC,GAAM,WAAagC,IAI3EjC,EAAOG,QAAQiC,SAAW,CACtBrC,KAAM,SAACsC,GAGHA,EAAUC,UAAU,WAAY,CAC5BC,SAAUR,EAAwBS,cAAc,WAAYH,QAM7DN,EAAAS,cAAP,SAAqBC,EAAWJ,GACpC,IAAIE,EAAqB,GAiBzB,OAfAR,EAAwBC,UAAUU,SAAQ,SAACC,EAAcV,GACrD,IAAIW,EAAMH,EAAO,IAAMR,EACvBI,EAAUC,UAAUM,EAAK,CACrBC,GAAI,SAACC,EAAYzC,GAEb0C,SAASC,YAAY,YAAY,EAAOF,GACxCzC,EAAE4C,YAENC,KAAMP,EACNG,MAAOb,EAAI,IAEfM,EAASL,KAAKU,MAIXL,QA3CGR,EAAAC,UAAsB,oBCFxC,SAAAmB,YAIkBA,EAAApD,KAAP,SAAYC,EAAaC,GAC5BkD,EAAqBnD,OAASA,EAG9BmD,EAAqBC,MAAQ,CACzB,QACA,UACA,cACA,UACA,YACA,SACA,YACA,aACA,QACA,SACA,kBACA,eACA,WAIJpD,EAAOG,QAAQkD,SAAW,CACtBtD,KAAM,SAAUsC,GAEZA,EAAU7B,EAAEL,QAAQkD,SAAWhB,EAAU7B,EAAEL,QAAQkD,UAAY,GAC/DhB,EAAUC,UAAU,WAAY,CAC5BC,SAAUY,EAAqBX,cAAc,WAAYH,QAO1Dc,EAAAX,cAAP,SAAqBC,EAAWJ,GACpC,IAAIE,EAAqB,GAmBzB,OAjBAY,EAAqBC,MAAMV,SAAQ,SAACY,EAAcrB,GAE9C,IAAIsB,EAAYD,EAAKE,cAAcC,QAAQ,IAAK,IAAIA,QAAQ,IAAK,IAC7Db,EAAMH,EAAO,IAAMc,EACvBlB,EAAUC,UAAUM,EAAK,CACrBC,GAAI,SAAUC,EAAYzC,GAEtB0C,SAASC,YAAY,YAAY,EAAOF,GACxCzC,EAAE4C,YAENC,KAAMI,EACNR,MAAOQ,IAEXf,EAASL,KAAKU,MAIXL,qBCzDf,SAAAmB,YAMkBA,EAAA3D,KAAP,SAAYC,EAAaC,GAC5ByD,EAA4B1D,OAASA,EACrC0D,EAA4BzD,KAAOA,EACnCD,EAAOG,QAAQwD,aAAe,CAC1B5D,KAAM,SAAUsC,GACZA,EAAU7B,EAAEL,QAAQwD,aAAetB,EAAU7B,EAAEL,QAAQwD,cAAgB,GAEvEtB,EAAUC,UAAU,eAAgB,CAChCO,GAAI,SAAUe,GACVF,EAA4BG,eAAeD,EAAQvB,OAI/DyB,IAAK,QAIEJ,EAAAG,eAAP,SAAsBD,EAAavD,GAE7BA,EAAEG,EAAED,OAAd,IACIiB,EAAiB,GAErBA,EAAKU,KAAK,+CACVV,EAAKU,KAAK,8DACVwB,EAA4BK,UAAUrB,SAAQ,SAACsB,GAC3CxC,EAAKU,KAAK,iBAAmB8B,EAAMC,YAAzB,yCACSD,EAAME,KAAO,6DAA+DF,EAAMG,GAD3F,0CAEoBH,EAAMI,MAF1B,2BAKd5C,EAAKU,KAAK,YACVV,EAAKU,KAAK,UAEV,IACImC,EAAShE,EAAEiE,UAAUZ,EAA4B1D,OAAOmC,MAAMuB,EAA4BzD,MAAMsE,qBAAsB/C,EAAKgD,KAAK,KAC/HC,GAAG,cAAc,WACd,IAAIC,EAAWC,OAAO,gBAAiBN,GAEvC,GAAIK,EAASE,OAAS,EAAG,CACrB,IAAIC,EAAUC,SAASJ,EAAS7C,MAAO,IAEnC7B,EAASqE,EAAOU,SAAS9D,KAAK,qBAClCjB,EAAOiB,KAAK,gBAAgB+D,SAC5BhF,EAAOiF,OAAO,+EAAiFJ,EAAU,kBACzGxE,EAAE6E,eACF7E,EAAE8E,GAAGC,QAAQ,aAGjB1E,YAAW,WACPL,EAAEgF,eACH,QAENZ,GAAG,aAAa,WACbpE,EAAEiF,eACFjF,EAAEgF,gBAGVhB,EAAOkB,SAAS,OAEhBZ,OAAO,wBAAyBN,GAAQmB,IAAI,SAASf,GAAG,SAAS,SAAUgB,GACvEd,OAAO,kBAAmBN,GAAQqB,YAAY,UAC9Cf,OAAOgB,MAAMZ,SAASQ,SAAS,cAKzB7B,EAAAkC,UAAP,SAAiB7B,GACpBL,EAA4BK,UAAYA,QAxE9BL,EAAAK,UAAmB,oBCDrC,SAAA8B,YAGkBA,EAAA9F,KAAP,SAAYC,EAAaC,GAC5B4F,EAA0B7F,OAASA,EAEnCA,EAAOG,QAAQ2F,KAAO,CAClB/F,KAAM,SAACsC,GAGHA,EAAUC,UAAU,OAAQ,CACxBO,GAAI,WACA,IAAIkD,EAAoB1D,EAAU1B,IAAIqF,eAEtC,GAAID,EAAkBE,WAAY,CAC9B,IAAIC,EAAQH,EAAkBI,WAAW,GAAGC,aAC5CF,EAAMG,iBAAiB1B,OAAO,qBAAqB2B,IAAI,IACvDP,EAAkBQ,kBAClBR,EAAkBS,SAASN,GAG/B7D,EAAUY,WAEVZ,EAAUoE,yBACVpE,EAAU8C,GAAGC,QAAQ,gBAI7B/C,EAAUqE,QAAQC,WAAWpE,SAAW,CAAC,IAAK,aAAc,OAAQ,KAAM,KAAM,KAAM,2BC5BtG,SAAAqE,YAGkBA,EAAA7G,KAAP,SAAYC,EAAaC,GAC5B2G,EAAgC5G,OAASA,EAEzCA,EAAOG,QAAQ0G,iBAAmB,CAC9B9G,KAAM,SAACsC,GACHA,EAAU7B,EAAEL,QAAQ0G,iBAAmBxE,EAAU7B,EAAEL,QAAQ0G,kBAAoB,GAC/ExE,EAAUC,UAAU,mBAAoB,CACpCO,GAAI,SAACe,EAAavD,GAEVA,EAAIgC,EAAR,IAEIb,EAAiB,GACrBA,EAAKU,KAAK,iCACVV,EAAKU,KAAK,oCACVV,EAAKU,KAAK,yBACVV,EAAKU,KAAK,UACVV,EAAKU,KAAK,UAEV4E,QAAQC,IAAI,oBAEZ,IAAI1C,EAAShE,EAAEiE,UAAU,aAAc9C,EAAKgD,KAAK,KAC5CC,GAAG,cAAc,WACdpE,EAAEiF,eACFjF,EAAE4C,WAEF,IAAI+D,EAAOrC,OAAO,WAAYN,GAAQxC,MAClCmF,GACAJ,EAAgC5G,OAAOiH,WAAW5G,EAAG2G,GAGzDtG,YAAW,WACPL,EAAEgF,eACH,QAENZ,GAAG,aAAa,WACbpE,EAAEiF,eACFjF,EAAEgF,wCCvClC,SAAA6B,YAKkBA,EAAAnH,KAAP,SAAYC,EAAaC,GAC5BiH,EAA2BlH,OAASA,EAEpCA,EAAOG,QAAQgH,YAAc,CACzBpH,KAAM,SAAUsC,GAEZA,EAAU7B,EAAEL,QAAQgH,YAAc9E,EAAU7B,EAAEL,QAAQgH,aAAe,GACrE9E,EAAUC,UAAU,cAAe,CAC/BC,SAAU2E,EAA2B1E,cAAc,cAAeH,GAClEyB,IAAK,UAGTpD,YAAW,WAGP,IAFA,IAAIuB,EAAY,EACZmF,EAAY,EACTnF,GAAK,GAAIA,IACZ,IAAKmF,EAAI,EAAGA,GAAK,GAAIA,IACjBF,EAA2BG,cAAc,IAAMpF,EAAI,KAAOmF,GAAK/E,EAAUvB,KAAKG,KAAK,2BAA6BgB,EAAI,KAAOmF,EAAI,gCAIvI/E,EAAUvB,KAAKG,KAAK,iCACfuE,IAAI,SACJf,GAAG,SAAS,WACTE,OAAO,6DAA6De,YAAY,aAGxFrD,EAAUvB,KAAKG,KAAK,6DACfuE,IAAI,yBAEJ8B,OAAM,SAAC7B,GAGJ,IAAI8B,EAAM5C,OAAOc,EAAE+B,QAAQpG,KAAK,SAASqG,MAAM,KAC3CC,EAAI5C,SAASyC,EAAI,GAAG9D,QAAQ,IAAK,IAAK,IACtCkE,EAAI7C,SAASyC,EAAI,GAAG9D,QAAQ,IAAK,IAAK,IAE1CyD,EAA2BU,UAAUF,EAAGC,MAGzC,SAAClC,GAGA,IAAI8B,EAAM5C,OAAOc,EAAE+B,QAAQpG,KAAK,SAASqG,MAAM,KAC3CC,EAAI5C,SAASyC,EAAI,GAAG9D,QAAQ,IAAK,IAAK,IACtCkE,EAAI7C,SAASyC,EAAI,GAAG9D,QAAQ,IAAK,IAAK,IAE1CyD,EAA2BU,UAAUF,EAAGC,QAEjD,QAMAT,EAAAW,WAAP,SAAkBH,EAAWC,GACjC,IAAInG,EAAiB,GACrBA,EAAKU,KAAK,mCAGV,IAFA,IAAID,EAAY,EACZmF,EAAY,EACTnF,GAAKyF,EAAGzF,IAAK,CAEhB,IADAT,EAAKU,KAAK,QACLkF,EAAI,EAAGA,GAAKO,EAAGP,IAChB5F,EAAKU,KAAK,mBAEdV,EAAKU,KAAK,SAGd,OADAV,EAAKU,KAAK,YACHV,GAGI0F,EAAAU,UAAP,SAAiBF,EAAWC,GAChChD,OAAO,6DAA6De,YAAY,UAIhF,IAFA,IAAIzD,EAAY,EACZmF,EAAY,EACTnF,GAAKyF,EAAGzF,IACX,IAAKmF,EAAI,EAAGA,GAAKO,EAAGP,IAEhBF,EAA2BG,cAAc,IAAMpF,EAAI,KAAOmF,GAAG7B,SAAS,WAKnE2B,EAAA1E,cAAP,SAAqBC,EAAWJ,GAKpC,IAJA,IAAIE,EAAqB,GAErBN,EAAY,EACZmF,EAAY,EACTnF,GAAK,GAAIA,IACZ,IAAKmF,EAAI,EAAGA,GAAK,GAAIA,IAAK,CACtB,IAAIxE,EAAc,gBAAkBX,EAAI,KAAOmF,EAAI,IAAM3E,EAGzDJ,EAAUC,UAAUM,EAAK,CACrBkF,UAAU,EACVjF,GAAI,SAAUe,GACV,IAAIpC,EAAO0F,EAA2BW,WAAWjE,EAAO8D,EAAG9D,EAAO+D,GAAGnD,KAAK,IAG1EnC,EAAUiD,eACVjD,EAAUY,WAEViE,EAA2BlH,OAAOiH,WAAW5E,EAAWb,IAE5D0B,KAAM,IACNJ,MAAO,CACH4E,EAAGzF,EACH0F,EAAGP,KAGX7E,EAASL,KAAKU,GAItB,OAAOL,QArHG2E,EAAAG,cAAqB,oBCDvC,SAAAU,YAOkBA,EAAAhI,KAAP,SAAYC,EAAaC,GAC5B8H,EAA4B/H,OAASA,EACrC+H,EAA4B9H,KAAOA,EAInCD,EAAOG,QAAQ6H,YAAc,CACzBjI,KAAM,SAAUsC,GACZA,EAAU7B,EAAEL,QAAQ6H,YAAc3F,EAAU7B,EAAEL,QAAQ6H,aAAe,GAErE3F,EAAUC,UAAU,cAAe,CAC/BO,GAAI,SAAUe,GAEVmE,EAA4BE,cAAcrE,EAAQvB,EAAW0F,EAA4BG,kBAIrGpE,IAAK,QAIEiE,EAAAE,cAAP,SAAqBrE,EAAavD,EAAQ6H,GAC9C,IAAIC,EAAc9H,EAAEG,EAAED,OAClB0B,EAAY,EACZmG,EAAYF,EAAatD,OAC7B,GAAS,GAALwD,EAAJ,CAIA,IAAI5G,EAAiB,GAIrB,IAFAA,EAAKU,KAAK,iCACVV,EAAKU,KAAK,cAAgBiG,EAAM,2BACzBlG,EAAImG,EAAGnG,IACVT,EAAKU,KAAK,4BAA8BD,EAA9B,mCACsBiG,EAAajG,GAAGoG,IADtC,oBAKd7G,EAAKU,KAAK,SACVV,EAAKU,KAAK,UAEV,IAAIoG,EAA6B,KAC7BjE,EAAShE,EAAEiE,UAAUyD,EAA4B/H,OAAOmC,MAAM4F,EAA4B9H,MAAMsI,eAAgB/G,EAAKgD,KAAK,KACzHC,GAAG,cAAc,WAId,GAHApE,EAAEiF,eACFjF,EAAE4C,WAEwB,MAAtBqF,EAA4B,CAC5B,IAAIE,EAAQN,EAAaI,GAAoBE,OAAS,KACtDnI,EAAEoI,QAAQ,cAAeP,EAAaI,GAAoBD,KACtDG,EAAQ,MACR7D,OAAO,YAAcuD,EAAaI,GAAoBD,IAAM,gBAAiBhI,EAAES,MAAMM,KAAK,QAAS,UAI3GV,YAAW,WACPL,EAAEgF,eACH,QAENZ,GAAG,aAAa,WACbpE,EAAEiF,eACFjF,EAAEgF,gBAGVV,OAAO,UAAWN,GAAQI,GAAG,SAAS,WAClCE,OAAO,KAAMN,GAAQqB,YAAY,UACjCf,OAAOgB,MAAMJ,SAAS,UACtB+C,EAAqB3D,OAAOgB,MAAM+C,KAAK,UAIjCX,EAAAY,aAAP,SAAoBC,GACvBb,EAA4BG,aAAe,GAC3CU,EAAMlG,SAAQ,SAACmG,GAEX,GADAA,EAAIC,UAAYD,EAAIC,WAAaD,EAAIR,IAAIZ,MAAM,KAAKsB,OACwB,GAAxEhB,EAA4BiB,iBAAiBC,QAAQJ,EAAIC,WAAkB,CAI3E,IAAKD,EAAIL,MAAO,CACZ,IAAIU,EAAS,IAAIC,MACjBD,EAAOE,aAAa,SAAUrB,EAA4BG,aAAatD,OAAS,IAChFsE,EAAOG,OAAS,SAAU5D,GACtB,GAAe,UAAXA,EAAE6D,MAA0B3D,KAAM6C,MAAO,CACzC,IAAIe,EAAOzE,SAAea,KAAM6D,aAAa,WAC7CzB,EAA4BG,aAAaqB,GAAMf,MAAc7C,KAAM6C,QAG3EU,EAAOO,IAAMZ,EAAIR,IACjBQ,EAAIL,MAAQ,KAEhBT,EAA4BG,aAAahG,KAAK2G,aAlG5Cd,EAAAG,aAAsB,GAItBH,EAAAiB,iBAA6B,CAAC,MAAO,MAAO,OAAQ,MAAO,MAAO,wBCLpF,SAAAU,YAUkBA,EAAA3J,KAAP,SAAYC,EAAaC,GAC5ByJ,EAA+B1J,OAASA,EACxC0J,EAA+BzJ,KAAOA,EAGtCD,EAAOG,QAAQwJ,gBAAkB,CAC7B5J,KAAM,SAAUsC,GACZA,EAAU7B,EAAEL,QAAQwJ,gBAAkBtH,EAAU7B,EAAEL,QAAQwJ,iBAAmB,GAC7EtH,EAAUC,UAAU,kBAAmB,CACnCO,GAAI,SAAUe,GAEV8F,EAA+BE,kBAAkBhG,EAAQvB,OAIrEyB,IAAK,QAIE4F,EAAAG,UAAP,SAAiBC,GACrB,OAAOJ,EAA+B1J,OAAOmC,MAAMuH,EAA+BzJ,MAAM6J,IAG7EJ,EAAAK,WAAP,SAAkB5B,EAAa3G,EAAgBwI,GACnDA,EAAMtH,SAAQ,SAACuH,GAEXzI,EAAKU,KAAK,qBACVV,EAAKU,KAAK,WACVV,EAAKU,KAAK,8BAAgCiG,EAAM,cAAgB8B,EAAS9F,GAA/D,YACM8F,EAAS7F,MAAQ,gBAAkB6F,EAASC,aAAe,YAAcD,EAAS9F,GAAK,OACvG3C,EAAKU,KAAK,WAAa+H,EAAS7F,MAAQ,aACpC6F,EAAShG,aAAegG,EAAShG,YAAYW,OAAS,GACtDpD,EAAKU,KAAK,WAAa+H,EAAShG,YAAc,QAElDzC,EAAKU,KAAK,YACVV,EAAKU,KAAK,aAKHwH,EAAAE,kBAAP,SAAyBhG,EAAavD,GAC1C,IAAI8H,EAAMuB,EAA+BvB,IAAM9H,EAAEG,EAAED,OAG/CiB,EAAiB,GAErBA,EAAKU,KAAK,kDACVV,EAAKU,KAAK,oDACVV,EAAKU,KAAK,uCAAyCwH,EAA+BG,UAAU,yBAA0B,YACtHrI,EAAKU,KAAK,2EACVV,EAAKU,KAAK,wDACVV,EAAKU,KAAK,oHACVV,EAAKU,KAAK,iHACVV,EAAKU,KAAK,OACVV,EAAKU,KAAK,+HACVV,EAAKU,KAAK,oGACVV,EAAKU,KAAK,mHACVV,EAAKU,KAAK,qEACVV,EAAKU,KAAK,QACVV,EAAKU,KAAK,UACVV,EAAKU,KAAK,WACVV,EAAKU,KAAK,UACVV,EAAKU,KAAK,yCACVV,EAAKU,KAAK,gDACVV,EAAKU,KAAK,qCAAuCwH,EAA+BG,UAAU,sBAAwB,QAClHrI,EAAKU,KAAK,SACVV,EAAKU,KAAK,8CACVV,EAAKU,KAAK,wCAA0CwH,EAA+BG,UAAU,0BAA4B,QACzHrI,EAAKU,KAAK,SACVV,EAAKU,KAAK,2CACVV,EAAKU,KAAK,qCAAuCwH,EAA+BG,UAAU,2BAA6B,QACvHrI,EAAKU,KAAK,SACVV,EAAKU,KAAK,4CACVV,EAAKU,KAAK,sCAAwCwH,EAA+BG,UAAU,wBAA0B,QACrHrI,EAAKU,KAAK,SACVV,EAAKU,KAAK,4CACVV,EAAKU,KAAK,sCAAwCwH,EAA+BG,UAAU,wBAA0B,QACrHrI,EAAKU,KAAK,SACVV,EAAKU,KAAK,SACVV,EAAKU,KAAK,iCACVV,EAAKU,KAAK,wDACVV,EAAKU,KAAK,gDACVwH,EAA+BK,WAAW5B,EAAK3G,EAAMkI,EAA+BS,iBACpF3I,EAAKU,KAAK,YACVV,EAAKU,KAAK,UACVV,EAAKU,KAAK,UAEVV,EAAKU,KAAK,UAGV,IAAImC,EAASqF,EAA+BrF,OAAShE,EAAEiE,UAAUoF,EAA+BG,UAAU,yBAA0BrI,EAAKgD,KAAK,KACzIC,GAAG,cAAc,WAEd,IAAIC,EAAWC,OAAO,gBAAiBN,GACvCyC,QAAQC,IAAI,WAAYrC,GAExB,IAAI7C,EAAM6C,EAAS7C,MAEfyH,EAAO5E,EAASgE,KAAK,QAKzB,GAHArI,EAAEiF,eACFjF,EAAE4C,WAEEpB,EAQA,OAPa,QAATyH,IACAA,EAAO,SAEE,QAATA,GAA2B,QAATA,IAClBA,EAAO,SAGHA,GACJ,IAAK,UAIDI,EAA+B1J,OAAOiH,WAAW5G,EAAG,iKACgBwB,EAAM,mBAAqBA,EAD3C,uFAGpD,MACJ,IAAK,QAID6H,EAA+B1J,OAAOiH,WAAW5G,EAAG,sKACqBwB,EAAM,mBAAqBA,EADhD,uFAGpD,MACJ,IAAK,QAID6H,EAA+B1J,OAAOiH,WAAW5G,EAAG,qKACqBwB,EAAM,mBAAqBA,EADhD,uFAIpD,MACJ,IAAK,OAID6H,EAA+B1J,OAAOiH,WAAW5G,EAAG,qKACoBwB,EAAM,mDAAqDA,EAD/E,uDAOhEnB,YAAW,WACPL,EAAEgF,eACH,QAENZ,GAAG,aAAa,WACbpE,EAAEiF,eACFjF,EAAEgF,gBAGVV,OAAO,eAAgBN,GAAQmB,IAAI,SAASf,GAAG,SAAS,SAAUgB,GAC9DA,EAAE2E,iBAEFzF,OAAO,kBAAmBN,GAAQqB,YAAY,mBAC9Cf,OAAOgB,MAAMZ,SAASQ,SAAS,mBAE/BmE,EAA+BW,SAASC,KAAK,CACzChB,KAAM3E,OAAOgB,MAAMvE,KAAK,cAAgB,MACxCgD,MAAOO,OAAO,aAAcN,GAAQxC,WAI5C8C,OAAO,kBAAmBN,GAAQmB,IAAI,SAASf,GAAG,SAAS,WACvDiF,EAA+BW,SAASC,KAAK,CACzChB,KAAM3E,OAAOgB,MAAMvE,KAAK,cAAgB,MACxCgD,MAAOO,OAAO,aAAcN,GAAQxC,YAKlC6H,EAAAa,gBAAP,SAAuBJ,GAC1BT,EAA+BS,gBAAkBA,EAEjDxF,OAAO,kBAAmB+E,EAA+BrF,QAAQmG,QACjE,IAAIC,EAAkB,GACtBf,EAA+BK,WAAWL,EAA+BvB,IAAKsC,EAAON,GACrFxF,OAAO,kBAAmB+E,EAA+BrF,QAAQY,OAAOwF,EAAMjG,KAAK,WAhMzEkF,EAAAS,gBAAyB,GAEzBT,EAAAW,SAA8B,IAAIK,EAAAA,aCHpD,iBAEA,SAAAC,YAOkBA,EAAA5K,KAAP,SAAYC,EAAaC,GAC5B0K,EAA+B3K,OAASA,EACxC2K,EAA+B1K,KAAOA,EAMtCD,EAAOG,QAAQyK,gBAAkB,CAC7B7K,KAAM,SAAUsC,GACZA,EAAU7B,EAAEL,QAAQyK,gBAAkBvI,EAAU7B,EAAEL,QAAQyK,iBAAmB,GAC7EvI,EAAUC,UAAU,kBAAmB,CACnCO,GAAI,SAAUe,GAEV+G,EAA+BE,kBAAkBjH,EAAQvB,OAIrEyB,IAAK,OAIT6G,EAA+BG,UAAU5I,KAAK,CAC1CiC,GAAI,cACJ4G,MAAO/K,EAAOmC,MAAMlC,GAAM+K,sBAC1BC,SAAU,KAEdN,EAA+BO,aAAa,oBACxC,QAAUlL,EAAOmC,MAAMlC,GAAM+K,sBAAwB,UAG9CL,EAAAE,kBAAP,SAAyBjH,EAAavD,GACxBA,EAAEG,EAAED,OAAtB,IAGIiB,EAAiB,GAErBA,EAAKU,KAAK,kDACVV,EAAKU,KAAK,yCACVyI,EAA+BG,UAAUpI,SAAQ,SAACyI,EAAalJ,GAC3DT,EAAKU,KAAK,aAAeiJ,EAAYhH,GAAK,4BAAmC,GAALlC,EAAS,kBAAoB,IAAM,MAC3GT,EAAKU,KAAK,mBAAqBiJ,EAAYhH,GAAK,mCAAqCgH,EAAYJ,MAAQ,QACzGvJ,EAAKU,KAAK,YAGdV,EAAKU,KAAK,SACVV,EAAKU,KAAK,iCAGVyI,EAA+BG,UAAUpI,SAAQ,SAACyI,EAAalJ,GAC3DT,EAAKU,KAAK,+BAAiCiJ,EAAYhH,GAAK,0BAAiC,GAALlC,EAAS,SAAW,IAAM,MAClHT,EAAKU,KAAK,iEACViJ,EAAYF,SAASvI,SAAQ,SAAC0I,EAAehE,GACzCgE,EAASlH,KAAOkH,EAASlH,MA9DpB,uCA+DL1C,EAAKU,KAAK,iBAAmBkJ,EAASnH,YAA5B,mCACSmH,EAASlH,KAAO,6DAA+DkH,EAASjH,GADjG,0CAEoBiH,EAAShH,MAF7B,qCAG0BgH,EAASnH,YAHnC,2BAMdzC,EAAKU,KAAK,YACVV,EAAKU,KAAK,gBAGdV,EAAKU,KAAK,UACVV,EAAKU,KAAK,UAIV,IAAImC,EAAShE,EAAEiE,UAAUqG,EAA+B3K,OAAOmC,MAAMwI,EAA+B1K,MAAMoL,sBAAuB7J,EAAKgD,KAAK,KACtIC,GAAG,cAAc,WACd,IACI5C,EADW8C,OAAO,gBAAiBN,GACpBxC,MAInBxB,EAAEiF,eACFjF,EAAE4C,WAEEpB,GACA8I,EAA+B3K,OAAOiH,WAAW5G,EAAGsK,EAA+BO,aAAarJ,IAGpGnB,YAAW,WACPL,EAAEgF,eACH,QAENZ,GAAG,aAAa,WACbpE,EAAEiF,eACFjF,EAAEgF,gBAEVhB,EAAOkB,SAAS,OAEhBZ,OAAO,eAAgBN,GAAQmB,IAAI,SAASf,GAAG,SAAS,SAAUgB,GAC9DA,EAAE2E,iBAEFzF,OAAO,kBAAmBN,GAAQqB,YAAY,mBAC9Cf,OAAOgB,MAAMZ,SAASQ,SAAS,mBAG/BZ,OAAO,iCAAkCN,GAAQqB,YAAY,UAC7Df,OAAO,IAAMA,OAAOgB,MAAMvE,KAAK,aAAamE,SAAS,aAEzDZ,OAAO,6BAA8BN,GAAQmB,IAAI,SAASf,GAAG,SAAS,SAAUgB,GAE5Ed,OAAO,uBAAwBN,GAAQqB,YAAY,UACnDf,OAAOgB,MAAMZ,SAASQ,SAAS,cAIzBoF,EAAAW,aAAP,SAAoBR,EAAkBI,GACzCP,EAA+BG,UAAYA,EAC3CH,EAA+BO,aAAeA,QAtHpCP,EAAAG,UAAmB,GACnBH,EAAAO,aAAoB,GCoBtC,IAAMK,EAAsB,uCA+CxB,SAAAC,EAAoBC,EACAC,EACAxL,GAFAyF,KAAA8F,GAAAA,EACA9F,KAAA+F,OAAAA,EACA/F,KAAAzF,KAAAA,EAxBIyF,KAAAgG,aAAuB,EACvBhG,KAAAiG,YAAsB,GACxBjG,KAAAkG,WAAqB,EAClClG,KAAAmG,QAAe,GAQhBnG,KAAAoG,WAAqB,EAEnBpG,KAAAqG,oBAA2B,IAAItB,EAAAA,aAElC/E,KAAAsG,OAAc,IAAIvB,EAAAA,aAIjB/E,KAAAuG,eAAsB,KACtBvG,KAAAwG,WAAkB,KA0B1BxG,KAAAyG,gBAAkB,SAACC,KArBf1G,KAAKoG,UAAYpG,KAAK8F,GAAGa,cAAcC,aAAa,YACpD5G,KAAK6G,MAAQ7G,KAAK8F,GAAGa,cAAc9C,aAAa,eAIpDgC,EAAAiB,UAAAC,SAAA,SAAS/E,GACL,OAAKhC,KAAKoG,UAINpE,EAAEgF,OAAShF,EAAEgF,MAAM/H,OAAS,EACrB,KAKJ,CACHgI,UAAU,GAVH,MAiBfpB,EAAAiB,UAAAI,iBAAA,SAAiBhK,GACb8C,KAAKyG,gBAAkBvJ,GAG3B2I,EAAAiB,UAAAK,kBAAA,aAIAtB,EAAAiB,UAAAM,SAAA,SAASJ,GAELhH,KAAKqH,OAASL,EAEVhH,KAAKgG,aACLhG,KAAKsH,aAILzB,EAAAiB,UAAAQ,UAAA,WAAA,IAAAC,EAAAvH,KACJwH,aAAaxH,KAAKuG,gBAClBvG,KAAKuG,eAAiBxL,YAAW,WAC7BwM,EAAKE,kBACN,MAGC5B,EAAAiB,UAAAW,cAAA,WACJ,IAAMC,EAAU,IAAIC,EAAAA,YAAY,CAC5BC,eAAgB,mBAChBC,oBAAqB,gCACrBC,gBAAiB,WACjBC,OAAU,aAGd/H,KAAKzF,KAAKoB,KAAKxB,EAAoBE,OAAO2N,YAAc,oBAAqBC,KAAKC,UAAU,CACxFC,IAAKnI,KAAKiG,YACVmC,QAASpI,KAAKqH,SACd,CACAK,QAASA,IACV3L,YACEC,MAAK,SAACC,QAKP4J,EAAAiB,UAAAuB,eAAA,WAAA,IAAAd,EAAAvH,KACJA,KAAKzF,KAAKoG,IAAIxG,EAAoBE,OAAO2N,YACrC,+BAAiChI,KAAKiG,aAAalK,YAClDC,MAAK,SAACC,GACHsL,EAAKf,WAAavK,EAGdsL,EAAKf,YAAcrH,SAASoI,EAAKf,WAAW8B,KAAM,IAAMf,EAAKrB,YAC7DqB,EAAKgB,4BAMb1C,EAAAiB,UAAAyB,sBAAA,WAAA,IAAAhB,EAAAvH,KACJA,KAAKwI,QAAQzF,KAAK,aAAa5H,KAAKmE,OAAO,wDACduG,EAAgBrJ,MAAMwD,KAAK1F,MAAMmO,gBADnB,gFAGc5C,EAAgBrJ,MAAMwD,KAAK1F,MAAMoO,eAH/C,4DAIc7C,EAAgBrJ,MAAMwD,KAAK1F,MAAMqO,gBAJ/C,0BAQ3C5N,YAAW,WACPiE,OAAO,0CAA2CuI,EAAKiB,QAAQzF,KAAK,aAAa5H,MAC5E2D,GAAG,SAAS,SAACgB,GAEVA,EAAE+B,OAAO+G,UAAY,MACrBrB,EAAKsB,oBAGb7J,OAAO,0CAA2CuI,EAAKiB,QAAQzF,KAAK,aAAa5H,MAC5E2D,GAAG,SAAS,SAACgB,GAEVA,EAAE+B,OAAO+G,UAAY,MACrBrB,EAAKuB,kBACL9J,OAAO,wBAAwB+J,YAExC,MAGAlD,EAAAiB,UAAA+B,eAAA,WAAA,IAAAtB,EAAAvH,KACHA,KAAKzF,KAAKoG,IAAIxG,EAAoBE,OAAO2N,YACrC,+BAAiChI,KAAKiG,aAAalK,YAClDC,MAAK,SAACC,GAEHsL,EAAKf,WAAa,KAClBxH,OAAO,wBAAwB+J,WAIpClD,EAAAiB,UAAAgC,gBAAA,WACC9I,KAAKwG,aACLxG,KAAKqH,OAASrH,KAAKwG,WAAW4B,QAC9BpI,KAAKwI,QAAQ9L,UAAU,OAAQsD,KAAKqH,QACpCrH,KAAKyG,gBAAgBzG,KAAKqH,QAC1BrH,KAAKkG,WAAa/G,SAASa,KAAKwG,WAAW8B,KAAM,MAIzDzC,EAAAiB,UAAAkC,WAAA,SAAWhC,GAGM,MAATA,IACAhH,KAAKqH,OAASL,EAKdhH,KAAKwI,QAAQ9L,UAAU,OAAQsD,KAAKqH,UAKpCxB,EAAAiB,UAAA1M,KAAA,SAAKE,GACTuL,EAAgBoD,QAAS,EAGrBpD,EAAgBrJ,QAChBwC,OAAOtC,UAAUF,MAAQqJ,EAAgBrJ,OAG7CwC,OAAOtC,UAAUwM,QAAgBC,OAAQC,wBAA0B,gDACnEpK,OAAOtC,UAAUhB,QAAU,sCAC3BsD,OAAOtC,UAAUsL,YAAc,0BAE/BhJ,OAAOtC,UAAU4E,WAAa,SAAU5G,EAAQmB,GAC5C,IACI,IAEInB,EAAEM,IAAIqO,UAAUC,cAAcC,UAAU1N,GAC1C,MAAO2N,GAEL,IAAI1D,EAAK1I,SAASqM,cAAc,OAChC3D,EAAG8C,UAAY/M,EAIf,IAHA,IACI6N,EADAC,EAAYvM,SAASwM,yBAGjBF,EAAO5D,EAAG+D,YACHF,EAAKG,YAAYJ,GAEhC,IAAInJ,EAAQ7F,EAAEM,IAAIqF,eAAeG,WAAW,GAC5CD,EAAMwJ,iBACNxJ,EAAMyJ,WAAWL,IAEvB,MAAOH,GAEL9O,EAAEoI,QAAQ,aAAcjH,GAE5BnB,EAAE4C,WACF5C,EAAE8E,GAAGC,QAAQ,cAGjB,IAAIwK,EAAW,CACXC,OAAQ,CAAC,OAAQ,SAAU,YAAa,iBACxCC,SAAU,CAAC,SAAU,KAAM,OAC3BC,QAAS,CAAC,cAAe,gBAAiB,eAAgB,eAC1DC,MAAO,CAAC,gBAAiB,gBAG7BlQ,EAAoBC,KAAK4E,OAAOtC,UAAWpC,EAAM0F,KAAKzF,MACtD6B,EAAwBhC,KAAK4E,OAAOtC,UAAWpC,GAC/CkD,EAAqBpD,KAAK4E,OAAOtC,UAAWpC,GAC5C4F,EAA0B9F,KAAK4E,OAAOtC,UAAWpC,GACjDyD,EAA4B3D,KAAK4E,OAAOtC,UAAWpC,GACnDiH,EAA2BnH,KAAK4E,OAAOtC,UAAWpC,GAClD2G,EAAgC7G,KAAK4E,OAAOtC,UAAWpC,GACvD8H,EAA4BhI,KAAK4E,OAAOtC,UAAWpC,GACnDyJ,EAA+B3J,KAAK4E,OAAOtC,UAAWpC,GACtD0K,EAA+B5K,KAAK4E,OAAOtC,UAAWpC,GAMtDuL,EAAgByE,MAAQ,CACpBC,OAAQ,CACJ,eACA,IACAN,EAASC,OAAQ,IACjB,WACA,WACA,YACA,YACA,IACA,mBACA,eAEJM,OAAQ,CACJ,eACA,IACAP,EAASC,OAAQ,IACjB,WACA,WACA,IACAD,EAASG,QACT,IACAH,EAASI,MACT,IACA,OACA,mBACA,cACA,iBACA,cAEJI,QAAS,CACL,WACA,eACA,IACAR,EAASC,OACT,IACA,aACA,WACA,WACA,YACA,YACA,IACAD,EAASG,QACT,IACAH,EAASI,MACT,IACA,OACA,mBACA,iBACA,cAEJK,OAAQ,CACJ,WACA,eACA,IACAT,EAASC,OACT,IACA,aACA,WACA,WACA,YACA,YACA,IACAD,EAASG,QACT,IACAH,EAASI,MACT,IACA,OACA,mBACA,cACA,kBACA,cACA,iBACA,cAEJM,KAAM,CACF,WACA,eACA,IACAV,EAASC,OACT,eACA,IACA,aACA,WACA,WACA,YACA,YACA,IACAD,EAASG,QACT,IACAH,EAASI,MACT,IACA,OACA,mBACA,cACA,kBACA,kBACA,cACA,iBACA,gBAKZxE,EAAAiB,UAAA8D,YAAA,SAAYC,GACR,GAAI7K,KAAK8K,YAAa,CAElB,IAAIhF,EAAK9G,OAAO,QAAUgB,KAAKwI,QAAQ9L,UAAU,QAAU,UAC3DoJ,EAAGxK,KAAK,IAAM0E,KAAK8K,YAAYC,KAAKtP,KAAK,MAAOuE,KAAK8K,YAAYE,MACjEhL,KAAK8K,YAAc,KACnB9K,KAAKwI,QAAQ9L,UAAU,OAAQoJ,EAAGjK,UAIlCgK,EAAAiB,UAAAmE,mBAAA,SAAmBpP,GAAnB,IAAA0L,EAAAvH,KAEJ,GAAI6F,EAAgBqF,iBAAiBC,KAAKtP,GAAO,CAC7C,IAGIkP,EAHAK,EAAgB,GAEhBtF,EAAK9G,OAAO,QAAUnD,EAAO,UAiBjC,OAfAiK,EAAGxK,KAAK,0BAA0B+P,MAAK,WAC9BrM,OAAOgB,MAAMvE,KAAK,QACnBsP,EAAMO,KAAKC,SAASC,SAAS,IAAIC,UAAU,EAAG,GAC9CzM,OAAOgB,MAAMvE,KAAK,KAAMsP,GACxBK,EAAO7O,KAAK,CACRwO,IAAKA,EACLjH,IAAK9D,KAAK8D,UAItB9D,KAAKwI,QAAQ9L,UAAU,OAAQoJ,EAAGjK,QAElCuP,EAAOrO,SAAQ,SAAA2O,GACXnE,EAAKlB,oBAAoB1B,KAAK+G,OAE3B,EAEX,OAAO,GAGX7F,EAAAiB,UAAA6E,SAAA,WAAA,IAAApE,EAAAvH,KAGIA,KAAK1F,KAAO0F,KAAK1F,MAAQ,KAEzB0F,KAAK5F,KAAK4F,KAAK1F,MACf0F,KAAKsG,OAAO3B,OAEZ3E,KAAK4L,KAAO5L,KAAK4L,MAAQ,SACzB5L,KAAKwI,QAAUxJ,OAAOgB,KAAK8F,GAAGa,eAE9B,IAAIkF,EAAUhG,EAAgByE,MAAMtK,KAAK4L,MACzC5L,KAAKmG,QAAUnG,KAAKmG,SAAW,KAE/B,IAAI2F,EAAa,EACjB,IAAiB,UAAb9L,KAAK4L,MAAiC,QAAb5L,KAAK4L,QACzBxO,SAAS2O,eAAenG,GAAsB,CAC/C,IAAIoG,EAAgB5O,SAASqM,cAAc,QAC3CzJ,KAAK+F,OAAOtC,aAAauI,EAAe,KAAMpG,GAC9C5F,KAAK+F,OAAOtC,aAAauI,EAAe,MAAO,cAC/ChM,KAAK+F,OAAOtC,aAAauI,EAAe,OAAQ,6DAChD5O,SAAS6O,KAAKnC,YAAYkC,GAG9BhM,KAAKmG,SAAwB,UAAbnG,KAAK4L,OACrBzK,QAAQC,IAAI,0BAA2BpB,KAAKmG,SAC5CnG,KAAKmG,QAAQpJ,SAAQ,SAACiK,GAClB,GAAa,gBAATA,EAAyB,CACzB,IAAIkF,EAAYrG,EAAgByE,MAAY,KAAEhH,QAAQ0D,GACtD6E,EAAQM,OAAOD,EAAW,EAAGlF,GAC7B8E,IAGJ,GAAa,mBAAT9E,EAA4B,CACxBkF,EAAYrG,EAAgByE,MAAY,KAAEhH,QAAQ0D,GAEtD6E,EAAQM,OAAOD,EADa,EACuBJ,EAAY,EAAG9E,QAK9EhH,KAAKwI,QAAQ9L,UAAU,WACvBsD,KAAKwI,QAAQ9L,UAAU,CACnB0P,KAAMP,EACNvR,KAAM0F,KAAK1F,KACX+R,QAAQ,EACRlC,UAAU,EACVmC,SAAuB,UAAbtM,KAAK4L,KACfW,QAAQ,IAEPzN,GAAG,YAAY,WACZ,IAAIjD,EAAe0L,EAAKiB,QAAQ9L,UAAU,QAErC6K,EAAK0D,mBAAmBpP,KACzB0L,EAAKd,gBAAgB5K,GACrB0L,EAAKH,SAASvL,OAKrBiD,GAAG,aAAa,WACb,IAAIjD,EAAe0L,EAAKiB,QAAQ9L,UAAU,QAErC6K,EAAK0D,mBAAmBpP,KACzB0L,EAAKd,gBAAgB5K,GACrB0L,EAAKH,SAASvL,OAKrBiD,GAAG,WAAW,SAACgB,GACZ,IAAIpF,EAAS6M,EAAKiB,QAAQzF,KAAK,aAE3BrI,IACAA,EAAES,KAAKyE,SAAS,aAAe2H,EAAKqE,MACpClR,EAAEkB,IAAIgE,SAAS,kBACflF,EAAEkB,IAAIgE,SAAS,oBAEXlF,EAAES,KAAK0H,SAAW,MAClBnI,EAAEkB,IAAIgE,SAAS,gBAK/B7E,YAAW,WAEHwM,EAAKvB,aACLuB,EAAKc,mBAEV,MAGPxC,EAAAiB,UAAA0F,YAAA,WACIxM,KAAKwI,QAAQ9L,UAAU,iBAldbmJ,EAAAyE,MAAa,GACbzE,EAAArJ,MAAa,GACbqJ,EAAAoD,QAAkB,EAClBpD,EAAAqF,iBAA2B,gEAJhCrF,GAAe4G,EAAAC,kBAAAD,EAAAE,YAAAF,EAAAC,kBAAAD,EAAAG,WAAAH,EAAAC,kBAAAG,EAAAC,+CAAfjH,EAAekH,UAAA,CAAA,CAAA,GAAA,mBAAA,KAAAC,OAAA,CAAAhH,YAAA,CAAA,gBAAA,eAAAC,YAAA,CAAA,gBAAA,eAAAC,WAAA,CAAA,cAAA,cAAAC,QAAA,UAAAyF,KAAA,OAAAtR,KAAA,OAAAwQ,YAAA,eAAAmC,QAAA,CAAA5G,oBAAA,uBAAA6G,SAAA,CAAAT,EAAAU,mBAbb,CACP,CACIC,QAASC,EAAAA,kBACTC,YAAaC,EAAAA,YAAW,WAAM,OAAA1H,KAC9B2H,OAAO,GAEX,CACIJ,QAASK,EAAAA,cACTH,YAAaC,EAAAA,YAAW,WAAM,OAAA1H,KAC9B2H,OAAO,KAEdf,EAAAiB,wFAEQ7H,EAAe,CAAA,MAf3B8H,EAAAA,gBAAU,CACPC,SAAU,qBACVC,UAAW,CACP,CACIT,QAASC,EAAAA,kBACTC,YAAaC,EAAAA,YAAW,WAAA,OAAA1H,KACxB2H,OAAO,GAEX,CACIJ,QAASK,EAAAA,cACTH,YAAaC,EAAAA,YAAW,WAAA,OAAA1H,KACxB2H,OAAO,0FAUSxH,YAAW,CAAA,MAAlC8H,EAAAA,YAAM,mBACiB7H,YAAW,CAAA,MAAlC6H,EAAAA,YAAM,mBACe5H,WAAU,CAAA,MAA/B4H,EAAAA,YAAM,iBACE3H,QAAO,CAAA,MAAf2H,EAAAA,QACQlC,KAAI,CAAA,MAAZkC,EAAAA,QACQxT,KAAI,CAAA,MAAZwT,EAAAA,QACQhD,YAAW,CAAA,MAAnBgD,EAAAA,QAOSzH,oBAAmB,CAAA,MAA5B0H,EAAAA,iBClDL,8CAAaC,oCAAAA,wCAVA,CACLC,EAAAA,qFASKD,EAAqB,CAAA,MAXjCE,EAAAA,eAAS,CACNC,QAAS,CACLF,EAAAA,kBAEJG,aAAc,CACVvI,GAEJwI,QAAS,CACLxI,mFAGKmI,EAAqB,CAAAI,aAAA,CAN1BvI,GAAesI,QAAA,CAHfF,EAAAA,kBAAgBI,QAAA,CAMhBxI","sourcesContent":["import {HttpClient} from '@angular/common/http';\nimport 'rxjs/add/operator/toPromise';\n\nexport class TrumbowygTidyPlugin {\n    public static editor: any;\n\n    public static init(editor: any, lang: string, http: HttpClient) {\n        TrumbowygTidyPlugin.editor = editor;\n\n        editor.plugins.tidy = {\n            init: (t: any) => {\n                // console.log('TrumbowygCodemirrorPlugin');\n\n                t.toggle = () => {\n                    var prefix = t.o.prefix;\n                    t.semanticCode(false, true);\n                    setTimeout(function () {\n                        t.doc.activeElement.blur();\n                        t.$box.toggleClass(prefix + 'editor-hidden ' + prefix + 'editor-visible');\n                        t.$btnPane.toggleClass(prefix + 'disable');\n                        t.$btnPane.find('.' + prefix + 'viewHTML-button').toggleClass(prefix + 'active');\n                        if (t.$box.hasClass(prefix + 'editor-visible')) {\n                            t.$ta.attr('tabindex', -1);\n                        } else {\n                            if (TrumbowygTidyPlugin.editor.tidyUrl) {\n                                // console.log(t.$ed.html());\n                                http.post(\n                                    TrumbowygTidyPlugin.editor.tidyUrl,\n                                    t.$ed.html(), {\n                                        responseType: 'text'\n                                    })\n                                    .toPromise()\n                                    .then((res: any) => {\n                                        // console.log('tidy res', res.text());\n                                        t.$ta.val(res);\n                                    });\n                            }\n                            t.$ta.removeAttr('tabindex');\n                        }\n                    }, 0);\n                };\n            }\n        }\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygFontSizePlugin {\n    public static editor: any;\n    public static fontSizes: string[] = [];\n\n    public static init(editor: any, lang: string) {\n        TrumbowygFontSizePlugin.editor = editor;\n\n        TrumbowygFontSizePlugin.fontSizes = [];\n\n        var i = 1;\n        for (; i <= 7; i++) {\n            //jQuery.trumbowyg.opts.fontSize.push($filter('translate')(\"Размер\") + ' ' + i);\n            TrumbowygFontSizePlugin.fontSizes.push(editor.langs[lang]['fontSize' + i]);\n        }\n\n        // Add all fonts in two dropdowns\n        editor.plugins.fontSize = {\n            init: (trumbowyg: any) => {\n                // console.log('fontSize init');\n                // trumbowyg.o.plugins.fontSize = trumbowyg.o.plugins.fontSize || {};\n                trumbowyg.addBtnDef('fontSize', {\n                    dropdown: TrumbowygFontSizePlugin.buildDropdown('fontSize', trumbowyg)\n                });\n            }\n        }\n    }\n\n    private static buildDropdown(func: any, trumbowyg: any) {\n        var dropdown: string[] = [];\n\n        TrumbowygFontSizePlugin.fontSizes.forEach((size: string, i: number) => {\n            var btn = func + '_' + i;\n            trumbowyg.addBtnDef(btn, {\n                fn: (param: any, t: any) => {\n                    //console.info(param, t);\n                    document.execCommand('fontSize', false, param);\n                    t.syncCode();\n                },\n                text: size,\n                param: i + 1\n            });\n            dropdown.push(btn);\n        });\n\n\n        return dropdown;\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygFontsPlugin {\n    public static editor: any;\n    public static fonts: string[];\n\n    public static init(editor: any, lang: string) {\n        TrumbowygFontsPlugin.editor = editor;\n\n        // Set default fonts\n        TrumbowygFontsPlugin.fonts = [\n            \"Arial\",\n            \"Courier\",\n            \"Courier New\",\n            \"Georgia\",\n            \"Helvetica\",\n            \"Impact\",\n            \"Monospace\",\n            \"Sans-serif\",\n            \"Serif\",\n            \"Tahoma\",\n            \"Times New Roman\",\n            \"Trebuchet MS\",\n            \"Verdana\"\n        ];\n\n        // Add all fonts in two dropdowns\n        editor.plugins.fontName = {\n            init: function (trumbowyg: any) {\n                // console.log('fontName trumbowyg', trumbowyg);\n                trumbowyg.o.plugins.fontName = trumbowyg.o.plugins.fontName || {};\n                trumbowyg.addBtnDef('fontName', {\n                    dropdown: TrumbowygFontsPlugin.buildDropdown('fontName', trumbowyg)\n                });\n            }\n        }\n\n    }\n\n    private static buildDropdown(func: any, trumbowyg: any) {\n        var dropdown: string[] = [];\n\n        TrumbowygFontsPlugin.fonts.forEach((font: string, i: number) => {\n            // console.info('TrumbowygFontsPlugin', font, i);\n            var fontAlias = font.toLowerCase().replace(' ', '').replace('-', '');\n            var btn = func + '_' + fontAlias;\n            trumbowyg.addBtnDef(btn, {\n                fn: function (param: any, t: any) {\n                    // console.info(param, t);\n                    document.execCommand('fontName', false, param);\n                    t.syncCode();\n                },\n                text: font,\n                param: font\n            });\n            dropdown.push(btn);\n        });\n\n\n        return dropdown;\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygSelectStylesPlugin {\n    public static allStyles: any[] = [];\n\n    public static editor: any;\n    public static lang: string;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectStylesPlugin.editor = editor;\n        TrumbowygSelectStylesPlugin.lang = lang;\n        editor.plugins.selectStyles = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectStyles = trumbowyg.o.plugins.selectStyles || {};\n\n                trumbowyg.addBtnDef('selectStyles', {\n                    fn: function (params: any) {\n                        TrumbowygSelectStylesPlugin.selectStylesCb(params, trumbowyg);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n    }\n\n    private static selectStylesCb(params: any, t: any) {\n\n        var pfx = t.o.prefix;\n        var html: string[] = [];\n\n        html.push('<div class=\"modal-container styles-select\">');\n        html.push('   <ul class=\"styles-list template-gallery list-unstyled\">');\n        TrumbowygSelectStylesPlugin.allStyles.forEach((style : any) => {\n            html.push('   <li title=\"' + style.description + '\" class=\"item style\"><label>' +\n                '<img src=\"' + style.icon + '\" class=\"select-template-icon\"><input type=\"radio\" value=\"' + style.id + '\" name=\"template\">' +\n                '<span class=\"title\"> ' + style.title + '</span>' +\n                '</label></li>');\n        });\n        html.push('   </ul>');\n        html.push('</div>');\n\n        var selectedImageIndex: number = null;\n        var $modal = t.openModal(TrumbowygSelectStylesPlugin.editor.langs[TrumbowygSelectStylesPlugin.lang].selectTemplatesStyle, html.join(''))\n            .on('tbwconfirm', function () {\n                var selected = jQuery('input:checked', $modal);\n\n                if (selected.length > 0) {\n                    var styleId = parseInt(selected.val(), 10);\n                   // console.log('styleId', styleId);\n                    var editor = $modal.parent().find('.trumbowyg-editor');\n                    editor.find('.customStyle').remove();\n                    editor.append('<style class=\"customStyle\">@import url(https://ets.davintoo.com/uploads/css/' + styleId + '.css);</style>');\n                    t.syncTextarea();\n                    t.$c.trigger('tbwchange');\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n\n        $modal.addClass('big');\n\n        jQuery('.styles-list li label', $modal).off('click').on('click', function (e:any) {\n            jQuery('.styles-list li', $modal).removeClass('active');\n            jQuery(this).parent().addClass('active');\n        });\n\n    };\n\n    public static setStyles(allStyles: any[]) {\n        TrumbowygSelectStylesPlugin.allStyles = allStyles;\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygInsertLeadPlugin {\n    public static editor: any;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygInsertLeadPlugin.editor = editor;\n\n        editor.plugins.lead = {\n            init: (trumbowyg: any) => {\n                // console.log('lead addBtnDef');\n\n                trumbowyg.addBtnDef('lead', {\n                    fn: () => {\n                        var documentSelection = trumbowyg.doc.getSelection();\n\n                        if (documentSelection.rangeCount) {\n                            var range = documentSelection.getRangeAt(0).cloneRange();\n                            range.surroundContents(jQuery('<p class=\"lead\"/>').get(0));\n                            documentSelection.removeAllRanges();\n                            documentSelection.addRange(range);\n                        }\n\n                        trumbowyg.syncCode();\n\n                        trumbowyg.updateButtonPaneStatus();\n                        trumbowyg.$c.trigger('tbwchange');\n                    }\n                });\n\n                trumbowyg.btnsDef.formatting.dropdown = ['p', 'blockquote', 'lead', 'h1', 'h2', 'h3', 'h4'];\n            }\n        }\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygInsertMediaEmbedPlugin {\n    public static editor: any;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygInsertMediaEmbedPlugin.editor = editor;\n\n        editor.plugins.insertMediaEmbed = {\n            init: (trumbowyg: any) => {\n                trumbowyg.o.plugins.insertMediaEmbed = trumbowyg.o.plugins.insertMediaEmbed || {};\n                trumbowyg.addBtnDef('insertMediaEmbed', {\n                    fn: (params: any, t: any) => {\n                        //console.log('insertMediaEmbed');\n                        var t = trumbowyg;\n\n                        var html: string[] = [];\n                        html.push('<div class=\"modal-container\">');\n                        html.push('<div class=\"modal-meadia-embed\">');\n                        html.push('<textarea></textarea>');\n                        html.push('</div>');\n                        html.push('</div>');\n\n                        console.log('insertMediaEmbed');\n\n                        var $modal = t.openModal('Embed Code', html.join(''))\n                            .on('tbwconfirm', () => {\n                                t.restoreRange();\n                                t.syncCode();\n\n                                var code = jQuery('textarea', $modal).val();\n                                if (code) {\n                                    TrumbowygInsertMediaEmbedPlugin.editor.insertHtml(t, code);\n                                }\n\n                                setTimeout(() => {\n                                    t.closeModal();\n                                }, 250);\n                            })\n                            .on('tbwcancel', () => {\n                                t.restoreRange();\n                                t.closeModal();\n                            });\n                    }\n                });\n            }\n        }\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygInsertTablePlugin {\n    public static editor: any;\n\n    public static elementsCache: any = {};\n\n    public static init(editor: any, lang: string) {\n        TrumbowygInsertTablePlugin.editor = editor;\n\n        editor.plugins.insertTable = {\n            init: function (trumbowyg: any) {\n                // console.log('trumbowyg', trumbowyg);\n                trumbowyg.o.plugins.insertTable = trumbowyg.o.plugins.insertTable || {};\n                trumbowyg.addBtnDef('insertTable', {\n                    dropdown: TrumbowygInsertTablePlugin.buildDropdown('insertTable', trumbowyg),\n                    tag: 'table'\n                });\n\n                setTimeout(function () {\n                    var i: number = 1;\n                    var j: number = 1;\n                    for (; i <= 10; i++) {\n                        for (j = 1; j <= 10; j++) {\n                            TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j] = trumbowyg.$box.find('.trumbowyg-insertTable_r' + i + '_c' + j + '_insertTable-dropdown-button');\n                        }\n                    }\n\n                    trumbowyg.$box.find('.trumbowyg-insertTable-button')\n                        .off('click')\n                        .on('click', function () {\n                            jQuery('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button').removeClass('active');\n                        });\n\n                    trumbowyg.$box.find('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button')\n                        .off('mouseenter mouseleave')\n                        // .on('hover', (e: any) => {\n                        .hover((e: any) => {\n                            //console.log(e.target.classList);\n                            //$(e.target).attr('class').split('_')\n                            var tmp = jQuery(e.target).attr('class').split('_');\n                            var r = parseInt(tmp[1].replace('r', ''), 10);\n                            var c = parseInt(tmp[2].replace('c', ''), 10);\n                            // console.log('i', tmp, r, c);\n                            TrumbowygInsertTablePlugin.fillCells(r, c);\n\n                            //console.log($(e.target).attr('class').split('_'));\n                        }, (e: any) => {\n                            // console.log(e);\n\n                            var tmp = jQuery(e.target).attr('class').split('_');\n                            var r = parseInt(tmp[1].replace('r', ''), 10);\n                            var c = parseInt(tmp[2].replace('c', ''), 10);\n                            // console.log('o', tmp, r, c);\n                            TrumbowygInsertTablePlugin.fillCells(r, c);\n                        });\n                }, 1000);\n            },\n            //tagHandler: colorTagHandler\n        }\n    }\n\n    private static buildTable(r: number, c: number) {\n        var html: string[] = [];\n        html.push('<table border=\"1\" width=\"100%\">');\n        var i: number = 1;\n        var j: number = 1;\n        for (; i <= r; i++) {\n            html.push('<tr>');\n            for (j = 1; j <= c; j++) {\n                html.push('<td>&nbsp;</td>');\n            }\n            html.push('</tr>');\n        }\n        html.push('</table>');\n        return html;\n    }\n\n    private static fillCells(r: number, c: number) {\n        jQuery('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button').removeClass('active');\n\n        var i: number = 1;\n        var j: number = 1;\n        for (; i <= r; i++) {\n            for (j = 1; j <= c; j++) {\n                // console.log(TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j]);\n                TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j].addClass('active');\n            }\n        }\n    }\n\n    private static buildDropdown(func: any, trumbowyg: any) {\n        var dropdown: string[] = [];\n\n        var i: number = 1;\n        var j: number = 1;\n        for (; i <= 10; i++) {\n            for (j = 1; j <= 10; j++) {\n                var btn: string = 'insertTable_r' + i + '_c' + j + '_' + func;\n                // trumbowyg.addBtnDef()\n                // console.log('trumbowyg', trumbowyg);\n                trumbowyg.addBtnDef(btn, {\n                    forceCss: true,\n                    fn: function (params: any) {\n                        var html = TrumbowygInsertTablePlugin.buildTable(params.r, params.c).join('');\n                        // console.info('HTML', params, t, buildTable(params.r, params.c).join(''), html);\n\n                        trumbowyg.restoreRange();\n                        trumbowyg.syncCode();\n\n                        TrumbowygInsertTablePlugin.editor.insertHtml(trumbowyg, html);\n                    },\n                    text: ' ',\n                    param: {\n                        r: i,\n                        c: j\n                    }\n                });\n                dropdown.push(btn);\n            }\n        }\n\n        return dropdown;\n    }\n}\n","import {Directive, Input, Output, EventEmitter, ElementRef, OnInit, OnChanges}         from '@angular/core';\n\ndeclare var jQuery: any;\n\nexport class TrumbowygSelectImagesPlugin {\n    public static editorImages: any[] = [];\n\n    public static editor: any;\n    public static lang: string;\n    public static imagesExtensions: string[] = ['jpg', 'png', 'jpeg', 'bmp', 'gif', 'svg'];\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectImagesPlugin.editor = editor;\n        TrumbowygSelectImagesPlugin.lang = lang;\n\n        // console.log('TrumbowygSelectImagesPlugin init', editor);\n\n        editor.plugins.selectImage = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectImage = trumbowyg.o.plugins.selectImage || {};\n                // console.log('selectImage trumbowyg', trumbowyg);\n                trumbowyg.addBtnDef('selectImage', {\n                    fn: function (params: any) {\n                        // console.log('selectImageCb', params, trumbowyg, editorImages);\n                        TrumbowygSelectImagesPlugin.selectImageCb(params, trumbowyg, TrumbowygSelectImagesPlugin.editorImages);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n    }\n\n    private static selectImageCb(params: any, t: any, editorImages: any[]) {\n        var pfx: string = t.o.prefix;\n        var i: number = 0,\n            l: number = editorImages.length;\n        if (l == 0) {\n            return;\n        }\n\n        var html: string[] = [];\n        var file: any = null;\n        html.push('<div class=\"modal-container\">');\n        html.push('<ul class=\"' + pfx + 'select-images gallery\">');\n        for (; i < l; i++) {\n            html.push('<li class=\"item\" data-i=\"' + i + '\"><label>' +\n                '<img width=\"50px\" src=\"' + editorImages[i].url + '\"/>' + //editorImages[i].name +\n                '</label></li>'\n            );\n        }\n        html.push('</ul>');\n        html.push('</div>');\n\n        var selectedImageIndex: number = null;\n        var $modal = t.openModal(TrumbowygSelectImagesPlugin.editor.langs[TrumbowygSelectImagesPlugin.lang].attachedImages, html.join(''))\n            .on('tbwconfirm', function () {\n                t.restoreRange();\n                t.syncCode();\n\n                if (selectedImageIndex != null) {\n                    var width = editorImages[selectedImageIndex].width || 1024;\n                    t.execCmd('insertImage', editorImages[selectedImageIndex].url);\n                    if (width > 1024) {\n                        jQuery('img[src=\"' + editorImages[selectedImageIndex].url + '\"]:not([alt])', t.$box).attr('width', '1024px');\n                    }\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n\n        jQuery('li.item', $modal).on('click', function () {\n            jQuery('li', $modal).removeClass('active');\n            jQuery(this).addClass('active');\n            selectedImageIndex = jQuery(this).data('i');\n        });\n    };\n\n    public static updateImages(files: any[]) {\n        TrumbowygSelectImagesPlugin.editorImages = [];\n        files.forEach((img: any) => {\n            img.extension = img.extension || img.url.split('.').pop();\n            if (TrumbowygSelectImagesPlugin.imagesExtensions.indexOf(img.extension) != -1) {\n                // if (img.url.substring(0, 8) != '/uploads') {\n                    // img.url = '/uploads' + img.url;\n                // }\n                if (!img.width) {\n                    var imgObj = new Image();\n                    imgObj.setAttribute('data-i', TrumbowygSelectImagesPlugin.editorImages.length + '');\n                    imgObj.onload = function (e) {\n                        if (e.type !== 'error' && (<any>this).width) {\n                            var indx = parseInt((<any>this).getAttribute('data-i'));\n                            TrumbowygSelectImagesPlugin.editorImages[indx].width = (<any>this).width;\n                        }\n                    }\n                    imgObj.src = img.url;\n                    img.width = 1024;\n                }\n                TrumbowygSelectImagesPlugin.editorImages.push(img);\n            }\n        });\n    }\n}\n","import {EventEmitter}         from '@angular/core';\n\ndeclare var jQuery: any;\n\nexport class TrumbowygSelectResourcesPlugin {\n    public static editorResources: any[] = [];\n\n    public static onSearch: EventEmitter<any> = new EventEmitter();\n\n    public static editor: any;\n    public static $modal: any;\n    public static lang: string;\n    public static pfx: string;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectResourcesPlugin.editor = editor;\n        TrumbowygSelectResourcesPlugin.lang = lang;\n        // TrumbowygSelectResourcesPlugin.onSearch = new EventEmitter();\n\n        editor.plugins.selectResources = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectResources = trumbowyg.o.plugins.selectResources || {};\n                trumbowyg.addBtnDef('selectResources', {\n                    fn: function (params: any) {\n                        // console.log('selectImageCb', params, trumbowyg, editorImages);\n                        TrumbowygSelectResourcesPlugin.selectResourcesCb(params, trumbowyg);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n    }\n\n    private static translate(str: string) {\n        return TrumbowygSelectResourcesPlugin.editor.langs[TrumbowygSelectResourcesPlugin.lang][str]\n    }\n\n    private static renderList(pfx: string, html: string[], items: any[]) {\n        items.forEach((resource: any) => {\n            // console.log('resource', resource);\n            html.push('<li class=\"item\">');\n            html.push('<label>');\n            html.push('<input type=\"radio\" name=\"r' + pfx + '\" data-id=\"' + resource.id + '\" ' +\n                'title=\"' + resource.title + '\" data-type=\"' + resource.display_type + '\" value=\"' + resource.id + '\"/>');\n            html.push('<strong>' + resource.title + '</strong>');\n            if (resource.description && resource.description.length > 0) {\n                html.push('<br/><i>' + resource.description + '</i>');\n            }\n            html.push('</label>');\n            html.push('</li>');\n        });\n    }\n\n\n    private static selectResourcesCb(params: any, t: any) {\n        var pfx = TrumbowygSelectResourcesPlugin.pfx = t.o.prefix;\n        //console.log('editorResources', editorResources);\n\n        var html: string[] = [];\n\n        html.push('<div class=\"resources-select modal-container\">');\n        html.push('<div class=\"resources-search cbr-input-control\">');\n        html.push('<label for=\"text\" class=\"cbr-label\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesSearch') +'</label>');\n        html.push('<input class=\"cbr-input cbr-input-default cbr-input-email\" type=\"text\">');\n        html.push('<span class=\"cbr-icon-input cbr-icon-input-primary\">');\n        html.push('<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"');\n        html.push('width=\"20\" height=\"20\" viewBox=\"0 0 451 451\" style=\"enable-background:new 0 0 451 451;\" xml:space=\"preserve\">');\n        html.push('<g>');\n        html.push('<path d=\"M447.05,428l-109.6-109.6c29.4-33.8,47.2-77.9,47.2-126.1C384.65,86.2,298.35,0,192.35,0C86.25,0,0.05,86.3,0.05,192.3');\n        html.push('s86.3,192.3,192.3,192.3c48.2,0,92.3-17.8,126.1-47.2L428.05,447c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4');\n        html.push('C452.25,441.8,452.25,433.2,447.05,428z M26.95,192.3c0-91.2,74.2-165.3,165.3-165.3c91.2,0,165.3,74.2,165.3,165.3');\n        html.push('s-74.1,165.4-165.3,165.4C101.15,357.7,26.95,283.5,26.95,192.3z\"/>');\n        html.push('</g>');\n        html.push('</svg>');\n        html.push('</span>');\n        html.push('</div>');\n        html.push('<ul class=\"cbr2-tabs\" role=\"tablist\">');\n        html.push('<li role=\"all\" class=\"cbr2-tabs-itemactive\">');\n        html.push('   <a data-type=\"all\"  role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesAll') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"gallery\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"gallery\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesGallery') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"html\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"html\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesHtmlSite') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"video\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"video\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesVideo') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"audio\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"audio\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesAudio') + '</a>');\n        html.push('</li>');\n        html.push('</ul>');\n        html.push('<div class=\"cbr-tab-content\">');\n        html.push('   <div role=\"tabpanel\" class=\"cbr-tab-pane active\">');\n        html.push('   <ul class=\"resources-list list-unstyled\">');\n        TrumbowygSelectResourcesPlugin.renderList(pfx, html, TrumbowygSelectResourcesPlugin.editorResources);\n        html.push('   </ul>');\n        html.push('</div>');\n        html.push('</div>');\n\n        html.push('</div>');\n\n        //console.log('html', html);\n        var $modal = TrumbowygSelectResourcesPlugin.$modal = t.openModal(TrumbowygSelectResourcesPlugin.translate('selectResourcesHeader'), html.join(''))\n            .on('tbwconfirm', function () {\n\n                var selected = jQuery('input:checked', $modal);\n                console.log('selected', selected);\n\n                var val = selected.val();\n                //var i = parseInt(selected.data('i'), 10);\n                var type = selected.data('type');\n\n                t.restoreRange();\n                t.syncCode();\n\n                if (val) {\n                    if (type === 'mp4') {\n                        type = 'video';\n                    }\n                    if (type === 'mp3' || type === 'acc') {\n                        type = 'audio';\n                    }\n\n                    switch (type) {\n                        case 'gallery':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"gallery\" data-ext=\"' + type + '\" data-gallery-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-gallery.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"640px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-gallery/dist/index.html?id=' + val + '\" data-item-id=\"' + val + '\" scrolling=\"no\" marginheight=\"0\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n                            break;\n                        case 'video':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"video\" data-ext=\"' + type + '\" data-video-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-video.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"480px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-video-player/dist/index.html?id=' + val + '\" data-item-id=\"' + val + '\" scrolling=\"no\" marginheight=\"0\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n                            break;\n                        case 'audio':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"audio\" data-ext=\"' + type + '\" data-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-audio.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"65px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-audio-player/dist/index.html?id=' + val + '\" data-item-id=\"' + val + '\" scrolling=\"no\" marginheight=\"0\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n\n                            break;\n                        case 'html':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"html\" data-ext=\"' + type + '\" data-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-resource.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"640px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-html-player/dist/index.html?id=' + val + '\" scrolling=\"no\" marginheight=\"0\" data-item-id=\"' + val + '\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n                            break;\n                    }\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n\n        jQuery('.cbr2-tabs a', $modal).off('click').on('click', function (e: any) {\n            e.preventDefault();\n\n            jQuery('.cbr2-tabs-item', $modal).removeClass('cbr-tabs-active');\n            jQuery(this).parent().addClass('cbr-tabs-active');\n\n            TrumbowygSelectResourcesPlugin.onSearch.emit({\n                type: jQuery(this).attr('data-type') || 'all',\n                title: jQuery('.cbr-input', $modal).val()\n            });\n        });\n\n        jQuery('.cbr-icon-input', $modal).off('click').on('click', function () {\n            TrumbowygSelectResourcesPlugin.onSearch.emit({\n                type: jQuery(this).attr('data-type') || 'all',\n                title: jQuery('.cbr-input', $modal).val()\n            });\n        });\n    }\n\n    public static updateResources(editorResources: any[]) {\n        TrumbowygSelectResourcesPlugin.editorResources = editorResources;\n        //\n        jQuery('.resources-list', TrumbowygSelectResourcesPlugin.$modal).empty();\n        var lhtml: string[] = [];\n        TrumbowygSelectResourcesPlugin.renderList(TrumbowygSelectResourcesPlugin.pfx, lhtml, editorResources);\n        jQuery('.resources-list', TrumbowygSelectResourcesPlugin.$modal).append(lhtml.join(''));\n    }\n}\n","// import {EventEmitter}         from '@angular/core';\n\ndeclare var jQuery: any;\n\nconst DEFAULT_ICON = 'themes/default/assets/img/t-icon.png';\n\nexport class TrumbowygSelectTemplatesPlugin {\n    public static templates: any[] = [];\n    public static allTemplates: any = {};\n\n    public static editor: any;\n    public static lang: string;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectTemplatesPlugin.editor = editor;\n        TrumbowygSelectTemplatesPlugin.lang = lang;\n\n        //console.log('init', editor, editor.langs, lang, editor.langs[lang].selectTemplatesNoData);\n\n        //TrumbowygSelectResourcesPlugin.onSearch = new EventEmitter();\n\n        editor.plugins.selectTemplates = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectTemplates = trumbowyg.o.plugins.selectTemplates || {};\n                trumbowyg.addBtnDef('selectTemplates', {\n                    fn: function (params: any) {\n                        // console.log('selectImageCb', params, trumbowyg, editorImages);\n                        TrumbowygSelectTemplatesPlugin.selectTemplatesCb(params, trumbowyg);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n\n\n        TrumbowygSelectTemplatesPlugin.templates.push({\n            id: 'tab-no-data',\n            label: editor.langs[lang].selectTemplatesNoData,\n            elements: []\n        });\n        TrumbowygSelectTemplatesPlugin.allTemplates['template-no-data'] =\n            '<div>' + editor.langs[lang].selectTemplatesNoData + '</div>';\n    }\n\n    private static selectTemplatesCb(params: any, t: any) {\n        var pfx: string = t.o.prefix;\n        //console.log('editorResources', editorResources);\n\n        var html: string[] = [];\n\n        html.push('<div class=\"modal-container templates-select\">');\n        html.push('<ul class=\"cbr2-tabs\" role=\"tablist\">');\n        TrumbowygSelectTemplatesPlugin.templates.forEach((templateSet, i) => {\n            html.push('<li role=\"' + templateSet.id + '\" class=\"cbr2-tabs-item ' + (i == 0 ? 'cbr-tabs-active' : '') + '\">');\n            html.push('   <a data-tab=\"' + templateSet.id + '\"  role=\"tab\" data-toggle=\"tab\">' + templateSet.label + '</a>');\n            html.push('</li>');\n        });\n\n        html.push('</ul>');\n        html.push('<div class=\"cbr-tab-content\">');\n\n\n        TrumbowygSelectTemplatesPlugin.templates.forEach((templateSet, i) => {\n            html.push('   <div role=\"tabpanel\" id=\"' + templateSet.id + '\" class=\"cbr-tab-pane ' + (i == 0 ? 'active' : '') + '\">');\n            html.push('   <ul class=\"templates-list template-gallery list-unstyled\">');\n            templateSet.elements.forEach((template: any, j: number) => {\n                template.icon = template.icon || DEFAULT_ICON;\n                html.push('   <li title=\"' + template.description + '\" class=\"item\"><label>' +\n                    '<img src=\"' + template.icon + '\" class=\"select-template-icon\"><input type=\"radio\" value=\"' + template.id + '\" name=\"template\">' +\n                    '<span class=\"title\"> ' + template.title + '</span>' +\n                    '<span class=\"description\"> ' + template.description + '</span>' +\n                    '</label></li>');\n            });\n            html.push('   </ul>');\n            html.push('   </div>');\n        });\n\n        html.push('</div>');\n        html.push('</div>');\n\n\n        //console.log('html', html);\n        var $modal = t.openModal(TrumbowygSelectTemplatesPlugin.editor.langs[TrumbowygSelectTemplatesPlugin.lang].selectTemplatesHeader, html.join(''))\n            .on('tbwconfirm', function () {\n                var selected = jQuery('input:checked', $modal);\n                var val = selected.val();\n                // console.log(val, allTemplates[val]);\n                // jQuery(this).off(pfx + 'confirm');\n\n                t.restoreRange();\n                t.syncCode();\n\n                if (val) {\n                    TrumbowygSelectTemplatesPlugin.editor.insertHtml(t, TrumbowygSelectTemplatesPlugin.allTemplates[val]);\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n        $modal.addClass('big');\n\n        jQuery('.cbr2-tabs a', $modal).off('click').on('click', function (e: any) {\n            e.preventDefault();\n\n            jQuery('.cbr2-tabs-item', $modal).removeClass('cbr-tabs-active');\n            jQuery(this).parent().addClass('cbr-tabs-active');\n\n            //    console.log('O_O', $(this).attr('data-tab'));\n            jQuery('.cbr-tab-content .cbr-tab-pane', $modal).removeClass('active');\n            jQuery('#' + jQuery(this).attr('data-tab')).addClass('active');\n        });\n        jQuery('.template-gallery li label', $modal).off('click').on('click', function (e: any) {\n            //console.log('O_O', e, $(this));\n            jQuery('.template-gallery li', $modal).removeClass('active');\n            jQuery(this).parent().addClass('active');\n        });\n    }\n\n    public static setTemplates(templates: any[], allTemplates: any) {\n        TrumbowygSelectTemplatesPlugin.templates = templates;\n        TrumbowygSelectTemplatesPlugin.allTemplates = allTemplates;\n    }\n}\n","import {\n    Directive,\n    Input,\n    forwardRef,\n    Output,\n    EventEmitter,\n    ElementRef,\n    OnInit,\n    OnDestroy,\n    OnChanges,\n    SimpleChanges, Renderer2\n} from '@angular/core';\nimport {HttpHeaders, HttpClient} from '@angular/common/http';\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR, NG_VALIDATORS, FormControl} from '@angular/forms';\n\nimport 'rxjs/add/operator/toPromise';\n\nimport {TrumbowygTidyPlugin} from './tidy';\nimport {TrumbowygFontSizePlugin} from './font-size';\nimport {TrumbowygFontsPlugin} from './fonts';\nimport {TrumbowygSelectStylesPlugin} from './select-styles';\nimport {TrumbowygInsertLeadPlugin} from './insert-lead';\nimport {TrumbowygInsertMediaEmbedPlugin} from './insert-media-embed';\nimport {TrumbowygInsertTablePlugin} from './insert-table';\nimport {TrumbowygSelectImagesPlugin} from './select-images';\nimport {TrumbowygSelectResourcesPlugin} from './select-resources';\nimport {TrumbowygSelectTemplatesPlugin} from './select-templates';\n\nconst LEGACY_BOOTSTRAP_ID = 'legacy-bootstrap-styles';\n\ndeclare var jQuery: any;\n\n@Directive({\n    selector: '[trumbowyg-editor]',\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TrumbowygEditor),\n            multi: true\n        },\n        {\n            provide: NG_VALIDATORS,\n            useExisting: forwardRef(() => TrumbowygEditor),\n            multi: true\n        }\n    ]\n})\nexport class TrumbowygEditor implements ControlValueAccessor, OnInit, OnChanges, OnDestroy {\n    public static modes: any = {};\n    public static langs: any = {};\n    public static inited: boolean = false;\n    public static localImageRegexp: RegExp = /src\\=\\\"data\\:image\\/(.*)\\\"/gi;\n\n    @Input('has-auto-save') hasAutoSave: boolean = false;\n    @Input('auto-save-key') autoSaveKey: string = '';\n    @Input('last-update') lastUpdate: number = 0;\n    @Input() addBtns: any = [];\n    @Input() mode: string;\n    @Input() lang: string;\n    @Input() base64Image: any;\n\n    private _name: string;\n    private _value: string;\n\n    private _required: boolean = false;\n\n    @Output() base64ImageInserted: any = new EventEmitter();\n\n    public onInit: any = new EventEmitter();\n\n    private element: any;\n\n    private _autoSaveTimer: any = null;\n    private _autoSaved: any = null;\n\n    constructor(private el: ElementRef,\n                private render: Renderer2,\n                private http: HttpClient) {\n        this._required = this.el.nativeElement.hasAttribute('required');\n        this._name = this.el.nativeElement.getAttribute('name');\n        // console.log('el', this._name, this._required);\n    }\n\n    validate(c: FormControl) {\n        if (!this._required) {\n            return null;\n        }\n\n        if (c.value && c.value.length > 0) {\n            return null;\n        }\n\n        // console.log('TrumbowygEditor NG_VALIDATORS', this._name, c.value, 'invalid');\n\n        return {\n            required: true\n        };\n    }\n\n    propagateChange = (_: any) => {\n    };\n\n    registerOnChange(fn: any) {\n        this.propagateChange = fn;\n    }\n\n    registerOnTouched() {\n        // console.log('registerOnTouched');\n    }\n\n    onChange(value: any) {\n        // console.log('onChange', this._value, value);\n        this._value = value;\n\n        if (this.hasAutoSave) {\n            this._autoSave();\n        }\n    }\n\n    private _autoSave() {\n        clearTimeout(this._autoSaveTimer);\n        this._autoSaveTimer = setTimeout(() => {\n            this._saveToServer();\n        }, 500);\n    }\n\n    private _saveToServer() {\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/json',\n            'If-Modified-Since': 'Mon, 26 Jul 1997 05:00:00 GMT',//no cache\n            'Cache-Control': 'no-cache',//no cache\n            'Pragma': 'no-cache'//no cache\n        });\n\n        this.http.post(TrumbowygTidyPlugin.editor.autoSaveUrl + '?action=auto-save', JSON.stringify({\n            key: this.autoSaveKey,\n            content: this._value\n        }), {\n            headers: headers\n        }).toPromise()\n            .then((res: any) => {\n                // console.log('_autoSave res', res.json());\n            });\n    }\n\n    private _checkAutoSave() {\n        this.http.get(TrumbowygTidyPlugin.editor.autoSaveUrl +\n            '?action=check-auto-save&key=' + this.autoSaveKey).toPromise()\n            .then((res: any) => {\n                this._autoSaved = res;\n                // console.log('_checkAutoSave res', this._autoSaved, this.lastUpdate);\n\n                if (this._autoSaved && parseInt(this._autoSaved.date, 10) > this.lastUpdate) {\n                    this._buildAutoSaveToolbar();\n                    // console.log('_hasAutoSave');\n                }\n            });\n    }\n\n    private _buildAutoSaveToolbar() {\n        this.element.data('trumbowyg').$box.append('<div class=\"trumbowyg-auto-save\">' +\n            '<span class=\"title\">' + TrumbowygEditor.langs[this.lang].hasAutoSavedMsg + '</span>' +\n            '<span class=\"buttons\">' +\n            '<button type=\"button\" class=\"button-sm-default\">' + TrumbowygEditor.langs[this.lang].autoSaveCancel + '</button>' +\n            '<button type=\"button\" class=\"button-sm-success\">' + TrumbowygEditor.langs[this.lang].autoSaveRestore + '</button>' +\n            '</span>' +\n            '</div>');\n\n        setTimeout(() => {\n            jQuery('.trumbowyg-auto-save .button-sm-default', this.element.data('trumbowyg').$box)\n                .on('click', (e: any) => {\n                    // console.log('cancel');\n                    e.target.innerHTML = '...';\n                    this.clearAutoSaved();\n                });\n\n            jQuery('.trumbowyg-auto-save .button-sm-success', this.element.data('trumbowyg').$box)\n                .on('click', (e: any) => {\n                    // console.log('restore');\n                    e.target.innerHTML = '...';\n                    this.restoreAutoSave();\n                    jQuery('.trumbowyg-auto-save').hide();\n                });\n        }, 200);\n    }\n\n    public clearAutoSaved() {\n        this.http.get(TrumbowygTidyPlugin.editor.autoSaveUrl +\n            '?action=clear-auto-save&key=' + this.autoSaveKey).toPromise()\n            .then((res: any) => {\n                // console.log('_checkAutoSave res', res.json());\n                this._autoSaved = null;\n                jQuery('.trumbowyg-auto-save').hide();\n            });\n    }\n\n    public restoreAutoSave() {\n        if (this._autoSaved) {\n            this._value = this._autoSaved.content;\n            this.element.trumbowyg('html', this._value);\n            this.propagateChange(this._value);\n            this.lastUpdate = parseInt(this._autoSaved.date, 10);\n        }\n    }\n\n    writeValue(value: any) {\n        // console.log('writeValue', this._name, value);\n\n        if (value != null) {\n            this._value = value;\n\n            // if (this._value.length == 0 && (/webkit/i).test(navigator.userAgent)) {\n            //     this.element.trumbowyg('html', '<p></p>');\n            // } else {\n            this.element.trumbowyg('html', this._value);\n            // }\n        }\n    }\n\n    private init(lang: string) {\n        TrumbowygEditor.inited = true;\n// console.log('init', lang);\n// console.log('TrumbowygEditor.langs', TrumbowygEditor.langs);\n        if (TrumbowygEditor.langs) {\n            jQuery.trumbowyg.langs = TrumbowygEditor.langs;\n        }\n\n        jQuery.trumbowyg.svgPath = (<any>window).TrumbowygEditorSvgPath || '/bower_components/trumbowyg/dist/ui/icons.svg';\n        jQuery.trumbowyg.tidyUrl = '/api/rest.php/trumbowyg?action=tidy';\n        jQuery.trumbowyg.autoSaveUrl = '/api/rest.php/trumbowyg';\n\n        jQuery.trumbowyg.insertHtml = function (t: any, html: string) {\n            try {\n                try {\n                    // <= IE10\n                    t.doc.selection.createRange().pasteHTML(html);\n                } catch (err) {\n                    // IE 11\n                    var el = document.createElement(\"div\");\n                    el.innerHTML = html;\n                    var frag: any = document.createDocumentFragment(),\n                        node: any,\n                        lastNode: any;\n                    while ((node = el.firstChild)) {\n                        lastNode = frag.appendChild(node);\n                    }\n                    var range = t.doc.getSelection().getRangeAt(0);\n                    range.deleteContents();\n                    range.insertNode(frag);\n                }\n            } catch (err) {\n                // Not IE\n                t.execCmd('insertHTML', html);\n            }\n            t.syncCode();\n            t.$c.trigger('tbwchange');\n        }\n\n        var btnsGrps = {\n            design: ['bold', 'italic', 'underline', 'strikethrough'],\n            semantic: ['strong', 'em', 'del'],\n            justify: ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],\n            lists: ['unorderedList', 'orderedList']\n        };\n\n        TrumbowygTidyPlugin.init(jQuery.trumbowyg, lang, this.http);\n        TrumbowygFontSizePlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygFontsPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygInsertLeadPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectStylesPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygInsertTablePlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygInsertMediaEmbedPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectImagesPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectResourcesPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectTemplatesPlugin.init(jQuery.trumbowyg, lang);\n\n        //console.trace();\n        //console.log('init', jQuery.trumbowyg);\n\n\n        TrumbowygEditor.modes = {\n            inline: [\n                'removeformat',\n                '|',\n                btnsGrps.design, '|',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                'insertMediaEmbed',\n                'selectImage'\n            ],\n            simple: [\n                'removeformat',\n                '|',\n                btnsGrps.design, '|',\n                'fontName',\n                'fontSize',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'selectImage',\n                'horizontalRule',\n                'fullscreen'\n            ],\n            noImage: [\n                'viewHTML',\n                'removeformat',\n                '|',\n                btnsGrps.design,\n                '|',\n                'formatting',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'horizontalRule',\n                'fullscreen'\n            ],\n            extend: [\n                'viewHTML',\n                'removeformat',\n                '|',\n                btnsGrps.design,\n                '|',\n                'formatting',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'selectImage',\n                'selectTemplates',\n                'insertTable',\n                'horizontalRule',\n                'fullscreen'\n            ],\n            full: [\n                'viewHTML',\n                'removeformat',\n                '|',\n                btnsGrps.design,\n                'selectStyles',\n                '|',\n                'formatting',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'selectImage',\n                'selectResources',\n                'selectTemplates',\n                'insertTable',\n                'horizontalRule',\n                'fullscreen'\n            ]\n        };\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (this.base64Image) {\n            //console.log('ngOnChanges base64Image', this.base64Image);\n            var el = jQuery('<div>' + this.element.trumbowyg('html') + '</div>');\n            el.find('#' + this.base64Image.uid).attr('src', this.base64Image.file);\n            this.base64Image = null;\n            this.element.trumbowyg('html', el.html());\n        }\n    }\n\n    private detectBase64Insert(html: string) {\n        //console.log('detectBase64Insert', html);\n        if (TrumbowygEditor.localImageRegexp.test(html)) {\n            var images: any[] = [];\n\n            var el = jQuery('<div>' + html + '</div>');\n            var uid: string;\n            el.find('img[src^=\"data:image\"]').each(function () {\n                if (!jQuery(this).attr('id')) {\n                    uid = Math.random().toString(36).substring(2, 9);\n                    jQuery(this).attr('id', uid);\n                    images.push({\n                        uid: uid,\n                        src: this.src\n                    });\n                }\n            });\n            this.element.trumbowyg('html', el.html());\n            //console.log('images', images);\n            images.forEach(image => {\n                this.base64ImageInserted.emit(image);\n            });\n            return true;\n        }\n        return false;\n    }\n\n    ngOnInit() {\n        //console.log('TrumbowygEditor ngOnInit');\n        //console.log('TrumbowygEditor langs', TrumbowygEditor.langs);\n        this.lang = this.lang || 'en';\n\n        this.init(this.lang);\n        this.onInit.emit();\n\n        this.mode = this.mode || 'simple';\n        this.element = jQuery(this.el.nativeElement);\n\n        var tmpBtns = TrumbowygEditor.modes[this.mode];\n        this.addBtns = this.addBtns || null;\n\n        let addElement = 0;\n        if (this.mode == 'extend' || this.mode == 'full') {\n            if (!document.getElementById(LEGACY_BOOTSTRAP_ID)) {\n                let linkContainer = document.createElement(\"LINK\");\n                this.render.setAttribute(linkContainer, 'id', LEGACY_BOOTSTRAP_ID);\n                this.render.setAttribute(linkContainer, 'rel', 'stylesheet');\n                this.render.setAttribute(linkContainer, 'href', '/node_modules/ng2-trumbowyg/assets/modified-bootstrap.css');\n                document.body.appendChild(linkContainer);\n            }\n        }\n        if (this.addBtns && this.mode == 'extend') {\n            console.log('TrumbowygEditor addBtns', this.addBtns);\n            this.addBtns.forEach((value: any) => {\n                if (value == 'selectStyles') {\n                    let elemIndex = TrumbowygEditor.modes['full'].indexOf(value);\n                    tmpBtns.splice(elemIndex, 0, value);\n                    addElement++;\n                }\n\n                if (value == 'selectResources') {\n                    let elemIndex = TrumbowygEditor.modes['full'].indexOf(value);\n                    let countPreviousElements = 1;\n                    tmpBtns.splice(elemIndex - countPreviousElements + addElement, 0, value);\n                }\n            });\n        }\n\n        this.element.trumbowyg('destroy');\n        this.element.trumbowyg({\n            btns: tmpBtns,\n            lang: this.lang,\n            mobile: true,\n            semantic: false,\n            autogrow: this.mode == 'inline',\n            tablet: true\n        })\n            .on('tbwpaste', () => {\n                var html: string = this.element.trumbowyg('html');\n                //console.log('tbwpaste', html);\n                if (!this.detectBase64Insert(html)) {\n                    this.propagateChange(html);\n                    this.onChange(html);\n                }\n                //console.log('tbwpaste', html);\n                //console.log('self.ngModelChange', self.ngModelChange);\n            })\n            .on('tbwchange', () => {\n                var html: string = this.element.trumbowyg('html');\n                //console.log('tbwchange', html);\n                if (!this.detectBase64Insert(html)) {\n                    this.propagateChange(html);\n                    this.onChange(html);\n                }\n                //console.log('tbwchange', html);\n                //console.log('self.ngModelChange', self.ngModelChange);\n            })\n            .on('tbwinit', (e: any) => {\n                let t: any = this.element.data('trumbowyg');\n                // console.log('tbwinit', e, t, this.element);\n                if (t) {\n                    t.$box.addClass('trumbowyg-' + this.mode);\n                    t.$ed.addClass('page-container');\n                    t.$ed.addClass('legacy-bootstrap');\n                    // console.log('tbwinit', e, t, t.$ed, t.$box);\n                    if (t.$box.width() >= 1200) {\n                        t.$ed.addClass('bordered');\n                    }\n                }\n            });\n\n        setTimeout(() => {\n            // console.log('hasAutoSave', this.hasAutoSave);\n            if (this.hasAutoSave) {\n                this._checkAutoSave();\n            }\n        }, 500);\n    }\n\n    ngOnDestroy() {\n        this.element.trumbowyg('destroy');\n    }\n}\n","import {NgModule} from '@angular/core';\nimport {HttpClientModule} from '@angular/common/http';\n\nimport {TrumbowygEditor} from './editor';\n\n@NgModule({\n    imports: [\n        HttpClientModule\n    ],\n    declarations: [\n        TrumbowygEditor\n    ],\n    exports: [\n        TrumbowygEditor\n    ]\n})\nexport class TrumbowygEditorModule {\n}\n"]}