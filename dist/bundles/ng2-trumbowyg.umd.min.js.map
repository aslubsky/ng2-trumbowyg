{"version":3,"sources":["../../src/tidy.ts","../../src/font-size.ts","../../src/fonts.ts","../../src/select-styles.ts","../../src/insert-lead.ts","../../src/insert-media-embed.ts","../../src/insert-table.ts","../../src/select-images.ts","../../src/select-resources.ts","../../src/select-templates.ts","../../src/editor.ts","../../src/module.ts"],"names":["TrumbowygTidyPlugin","init","editor","lang","http","plugins","tidy","t","toggle","prefix","o","semanticCode","setTimeout","doc","activeElement","blur","$box","toggleClass","$btnPane","find","hasClass","$ta","attr","tidyUrl","post","$ed","html","toPromise","then","res","val","text","removeAttr","TrumbowygFontSizePlugin","fontSizes","i","push","langs","fontSize","trumbowyg","addBtnDef","dropdown","buildDropdown","func","forEach","size","btn","fn","param","document","execCommand","syncCode","TrumbowygFontsPlugin","fonts","fontName","font","fontAlias","toLowerCase","replace","TrumbowygSelectStylesPlugin","selectStyles","params","selectStylesCb","tag","allStyles","style","description","icon","id","title","$modal","openModal","selectTemplatesStyle","join","on","selected","jQuery","length","styleId","parseInt","parent","remove","append","syncTextarea","$c","trigger","closeModal","restoreRange","addClass","off","e","removeClass","this","setStyles","TrumbowygInsertLeadPlugin","lead","documentSelection","getSelection","rangeCount","range","getRangeAt","cloneRange","surroundContents","get","removeAllRanges","addRange","updateButtonPaneStatus","btnsDef","formatting","TrumbowygInsertMediaEmbedPlugin","insertMediaEmbed","console","log","code","insertHtml","TrumbowygInsertTablePlugin","insertTable","j","elementsCache","hover","tmp","target","split","r","c","fillCells","buildTable","forceCss","TrumbowygSelectImagesPlugin","selectImage","selectImageCb","editorImages","pfx","l","url","selectedImageIndex","attachedImages","width","execCmd","data","updateImages","files","img","extension","pop","imagesExtensions","indexOf","imgObj","Image","setAttribute","onload","type","indx","getAttribute","src","TrumbowygSelectResourcesPlugin","selectResources","selectResourcesCb","translate","str","renderList","items","resource","display_type","editorResources","preventDefault","onSearch","emit","updateResources","empty","lhtml","EventEmitter","TrumbowygSelectTemplatesPlugin","selectTemplates","selectTemplatesCb","templates","label","selectTemplatesNoData","elements","allTemplates","templateSet","template","selectTemplatesHeader","setTemplates","TrumbowygEditor","el","render","hasAutoSave","autoSaveKey","lastUpdate","addBtns","_required","base64ImageInserted","onInit","_autoSaveTimer","_autoSaved","propagateChange","_","nativeElement","hasAttribute","_name","prototype","validate","value","required","registerOnChange","registerOnTouched","onChange","_value","_autoSave","_this","clearTimeout","_saveToServer","headers","HttpHeaders","Content-Type","If-Modified-Since","Cache-Control","Pragma","autoSaveUrl","JSON","stringify","key","content","_checkAutoSave","date","_buildAutoSaveToolbar","element","hasAutoSavedMsg","autoSaveCancel","autoSaveRestore","innerHTML","clearAutoSaved","restoreAutoSave","hide","writeValue","inited","svgPath","window","TrumbowygEditorSvgPath","selection","createRange","pasteHTML","err","createElement","node","frag","createDocumentFragment","firstChild","appendChild","deleteContents","insertNode","btnsGrps","design","semantic","justify","lists","modes","inline","simple","noImage","extend","full","ngOnChanges","changes","base64Image","uid","file","detectBase64Insert","localImageRegexp","test","images","each","Math","random","toString","substring","image","ngOnInit","mode","tmpBtns","addElement","getElementById","linkContainer","body","elemIndex","splice","btns","mobile","autogrow","tablet","ngOnDestroy","i0","ɵɵdirectiveInject","ElementRef","Renderer2","i1","HttpClient","selectors","inputs","outputs","features","ɵɵProvidersFeature","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","NG_VALIDATORS","ɵɵNgOnChangesFeature","TrumbowygEditorModule","imports","HttpClientModule","declarations","exports"],"mappings":"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","sourcesContent":["import {HttpClient} from '@angular/common/http';\nimport 'rxjs/add/operator/toPromise';\n\nexport class TrumbowygTidyPlugin {\n    public static editor: any;\n\n    public static init(editor: any, lang: string, http: HttpClient) {\n        TrumbowygTidyPlugin.editor = editor;\n\n        editor.plugins.tidy = {\n            init: (t: any) => {\n                // console.log('TrumbowygCodemirrorPlugin');\n\n                t.toggle = () => {\n                    var prefix = t.o.prefix;\n                    t.semanticCode(false, true);\n                    setTimeout(function () {\n                        t.doc.activeElement.blur();\n                        t.$box.toggleClass(prefix + 'editor-hidden ' + prefix + 'editor-visible');\n                        t.$btnPane.toggleClass(prefix + 'disable');\n                        t.$btnPane.find('.' + prefix + 'viewHTML-button').toggleClass(prefix + 'active');\n                        if (t.$box.hasClass(prefix + 'editor-visible')) {\n                            t.$ta.attr('tabindex', -1);\n                        } else {\n                            if (TrumbowygTidyPlugin.editor.tidyUrl) {\n                                // console.log(t.$ed.html());\n                                http.post(TrumbowygTidyPlugin.editor.tidyUrl, t.$ed.html()).toPromise()\n                                    .then((res: any) => {\n                                        // console.log('tidy res', res.text());\n                                        t.$ta.val(res.text());\n                                    });\n                            }\n                            t.$ta.removeAttr('tabindex');\n                        }\n                    }, 0);\n                };\n            }\n        }\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygFontSizePlugin {\n    public static editor: any;\n    public static fontSizes: string[] = [];\n\n    public static init(editor: any, lang: string) {\n        TrumbowygFontSizePlugin.editor = editor;\n\n        TrumbowygFontSizePlugin.fontSizes = [];\n\n        var i = 1;\n        for (; i <= 7; i++) {\n            //jQuery.trumbowyg.opts.fontSize.push($filter('translate')(\"Ð Ð°Ð·Ð¼ÐµÑ\") + ' ' + i);\n            TrumbowygFontSizePlugin.fontSizes.push(editor.langs[lang]['fontSize' + i]);\n        }\n\n        // Add all fonts in two dropdowns\n        editor.plugins.fontSize = {\n            init: (trumbowyg: any) => {\n                // console.log('fontSize init');\n                // trumbowyg.o.plugins.fontSize = trumbowyg.o.plugins.fontSize || {};\n                trumbowyg.addBtnDef('fontSize', {\n                    dropdown: TrumbowygFontSizePlugin.buildDropdown('fontSize', trumbowyg)\n                });\n            }\n        }\n    }\n\n    private static buildDropdown(func: any, trumbowyg: any) {\n        var dropdown: string[] = [];\n\n        TrumbowygFontSizePlugin.fontSizes.forEach((size: string, i: number) => {\n            var btn = func + '_' + i;\n            trumbowyg.addBtnDef(btn, {\n                fn: (param: any, t: any) => {\n                    //console.info(param, t);\n                    document.execCommand('fontSize', false, param);\n                    t.syncCode();\n                },\n                text: size,\n                param: i + 1\n            });\n            dropdown.push(btn);\n        });\n\n\n        return dropdown;\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygFontsPlugin {\n    public static editor: any;\n    public static fonts: string[];\n\n    public static init(editor: any, lang: string) {\n        TrumbowygFontsPlugin.editor = editor;\n\n        // Set default fonts\n        TrumbowygFontsPlugin.fonts = [\n            \"Arial\",\n            \"Courier\",\n            \"Courier New\",\n            \"Georgia\",\n            \"Helvetica\",\n            \"Impact\",\n            \"Monospace\",\n            \"Sans-serif\",\n            \"Serif\",\n            \"Tahoma\",\n            \"Times New Roman\",\n            \"Trebuchet MS\",\n            \"Verdana\"\n        ];\n\n        // Add all fonts in two dropdowns\n        editor.plugins.fontName = {\n            init: function (trumbowyg: any) {\n                // console.log('fontName trumbowyg', trumbowyg);\n                trumbowyg.o.plugins.fontName = trumbowyg.o.plugins.fontName || {};\n                trumbowyg.addBtnDef('fontName', {\n                    dropdown: TrumbowygFontsPlugin.buildDropdown('fontName', trumbowyg)\n                });\n            }\n        }\n\n    }\n\n    private static buildDropdown(func: any, trumbowyg: any) {\n        var dropdown: string[] = [];\n\n        TrumbowygFontsPlugin.fonts.forEach((font: string, i: number) => {\n            // console.info('TrumbowygFontsPlugin', font, i);\n            var fontAlias = font.toLowerCase().replace(' ', '').replace('-', '');\n            var btn = func + '_' + fontAlias;\n            trumbowyg.addBtnDef(btn, {\n                fn: function (param: any, t: any) {\n                    // console.info(param, t);\n                    document.execCommand('fontName', false, param);\n                    t.syncCode();\n                },\n                text: font,\n                param: font\n            });\n            dropdown.push(btn);\n        });\n\n\n        return dropdown;\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygSelectStylesPlugin {\n    public static allStyles: any[] = [];\n\n    public static editor: any;\n    public static lang: string;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectStylesPlugin.editor = editor;\n        TrumbowygSelectStylesPlugin.lang = lang;\n        editor.plugins.selectStyles = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectStyles = trumbowyg.o.plugins.selectStyles || {};\n\n                trumbowyg.addBtnDef('selectStyles', {\n                    fn: function (params: any) {\n                        TrumbowygSelectStylesPlugin.selectStylesCb(params, trumbowyg);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n    }\n\n    private static selectStylesCb(params: any, t: any) {\n\n        var pfx = t.o.prefix;\n        var html: string[] = [];\n\n        html.push('<div class=\"modal-container styles-select\">');\n        html.push('   <ul class=\"styles-list template-gallery list-unstyled\">');\n        TrumbowygSelectStylesPlugin.allStyles.forEach((style : any) => {\n            html.push('   <li title=\"' + style.description + '\" class=\"item style\"><label>' +\n                '<img src=\"' + style.icon + '\" class=\"select-template-icon\"><input type=\"radio\" value=\"' + style.id + '\" name=\"template\">' +\n                '<span class=\"title\"> ' + style.title + '</span>' +\n                '</label></li>');\n        });\n        html.push('   </ul>');\n        html.push('</div>');\n\n        var selectedImageIndex: number = null;\n        var $modal = t.openModal(TrumbowygSelectStylesPlugin.editor.langs[TrumbowygSelectStylesPlugin.lang].selectTemplatesStyle, html.join(''))\n            .on('tbwconfirm', function () {\n                var selected = jQuery('input:checked', $modal);\n\n                if (selected.length > 0) {\n                    var styleId = parseInt(selected.val(), 10);\n                   // console.log('styleId', styleId);\n                    var editor = $modal.parent().find('.trumbowyg-editor');\n                    editor.find('.customStyle').remove();\n                    editor.append('<style class=\"customStyle\">@import url(https://ets.davintoo.com/uploads/css/' + styleId + '.css);</style>');\n                    t.syncTextarea();\n                    t.$c.trigger('tbwchange');\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n\n        $modal.addClass('big');\n\n        jQuery('.styles-list li label', $modal).off('click').on('click', function (e:any) {\n            jQuery('.styles-list li', $modal).removeClass('active');\n            jQuery(this).parent().addClass('active');\n        });\n\n    };\n\n    public static setStyles(allStyles: any[]) {\n        TrumbowygSelectStylesPlugin.allStyles = allStyles;\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygInsertLeadPlugin {\n    public static editor: any;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygInsertLeadPlugin.editor = editor;\n\n        editor.plugins.lead = {\n            init: (trumbowyg: any) => {\n                // console.log('lead addBtnDef');\n\n                trumbowyg.addBtnDef('lead', {\n                    fn: () => {\n                        var documentSelection = trumbowyg.doc.getSelection();\n\n                        if (documentSelection.rangeCount) {\n                            var range = documentSelection.getRangeAt(0).cloneRange();\n                            range.surroundContents(jQuery('<p class=\"lead\"/>').get(0));\n                            documentSelection.removeAllRanges();\n                            documentSelection.addRange(range);\n                        }\n\n                        trumbowyg.syncCode();\n\n                        trumbowyg.updateButtonPaneStatus();\n                        trumbowyg.$c.trigger('tbwchange');\n                    }\n                });\n\n                trumbowyg.btnsDef.formatting.dropdown = ['p', 'blockquote', 'lead', 'h1', 'h2', 'h3', 'h4'];\n            }\n        }\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygInsertMediaEmbedPlugin {\n    public static editor: any;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygInsertMediaEmbedPlugin.editor = editor;\n\n        editor.plugins.insertMediaEmbed = {\n            init: (trumbowyg: any) => {\n                trumbowyg.o.plugins.insertMediaEmbed = trumbowyg.o.plugins.insertMediaEmbed || {};\n                trumbowyg.addBtnDef('insertMediaEmbed', {\n                    fn: (params: any, t: any) => {\n                        //console.log('insertMediaEmbed');\n                        var t = trumbowyg;\n\n                        var html: string[] = [];\n                        html.push('<div class=\"modal-container\">');\n                        html.push('<div class=\"modal-meadia-embed\">');\n                        html.push('<textarea></textarea>');\n                        html.push('</div>');\n                        html.push('</div>');\n\n                        console.log('insertMediaEmbed');\n\n                        var $modal = t.openModal('Embed Code', html.join(''))\n                            .on('tbwconfirm', () => {\n                                t.restoreRange();\n                                t.syncCode();\n\n                                var code = jQuery('textarea', $modal).val();\n                                if (code) {\n                                    TrumbowygInsertMediaEmbedPlugin.editor.insertHtml(t, code);\n                                }\n\n                                setTimeout(() => {\n                                    t.closeModal();\n                                }, 250);\n                            })\n                            .on('tbwcancel', () => {\n                                t.restoreRange();\n                                t.closeModal();\n                            });\n                    }\n                });\n            }\n        }\n    }\n}\n","declare var jQuery: any;\n\nexport class TrumbowygInsertTablePlugin {\n    public static editor: any;\n\n    public static elementsCache: any = {};\n\n    public static init(editor: any, lang: string) {\n        TrumbowygInsertTablePlugin.editor = editor;\n\n        editor.plugins.insertTable = {\n            init: function (trumbowyg: any) {\n                // console.log('trumbowyg', trumbowyg);\n                trumbowyg.o.plugins.insertTable = trumbowyg.o.plugins.insertTable || {};\n                trumbowyg.addBtnDef('insertTable', {\n                    dropdown: TrumbowygInsertTablePlugin.buildDropdown('insertTable', trumbowyg),\n                    tag: 'table'\n                });\n\n                setTimeout(function () {\n                    var i: number = 1;\n                    var j: number = 1;\n                    for (; i <= 10; i++) {\n                        for (j = 1; j <= 10; j++) {\n                            TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j] = trumbowyg.$box.find('.trumbowyg-insertTable_r' + i + '_c' + j + '_insertTable-dropdown-button');\n                        }\n                    }\n\n                    trumbowyg.$box.find('.trumbowyg-insertTable-button')\n                        .off('click')\n                        .on('click', function () {\n                            jQuery('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button').removeClass('active');\n                        });\n\n                    trumbowyg.$box.find('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button')\n                        .off('mouseenter mouseleave')\n                        // .on('hover', (e: any) => {\n                        .hover((e: any) => {\n                            //console.log(e.target.classList);\n                            //$(e.target).attr('class').split('_')\n                            var tmp = jQuery(e.target).attr('class').split('_');\n                            var r = parseInt(tmp[1].replace('r', ''), 10);\n                            var c = parseInt(tmp[2].replace('c', ''), 10);\n                            // console.log('i', tmp, r, c);\n                            TrumbowygInsertTablePlugin.fillCells(r, c);\n\n                            //console.log($(e.target).attr('class').split('_'));\n                        }, (e: any) => {\n                            // console.log(e);\n\n                            var tmp = jQuery(e.target).attr('class').split('_');\n                            var r = parseInt(tmp[1].replace('r', ''), 10);\n                            var c = parseInt(tmp[2].replace('c', ''), 10);\n                            // console.log('o', tmp, r, c);\n                            TrumbowygInsertTablePlugin.fillCells(r, c);\n                        });\n                }, 1000);\n            },\n            //tagHandler: colorTagHandler\n        }\n    }\n\n    private static buildTable(r: number, c: number) {\n        var html: string[] = [];\n        html.push('<table border=\"1\" width=\"100%\">');\n        var i: number = 1;\n        var j: number = 1;\n        for (; i <= r; i++) {\n            html.push('<tr>');\n            for (j = 1; j <= c; j++) {\n                html.push('<td>&nbsp;</td>');\n            }\n            html.push('</tr>');\n        }\n        html.push('</table>');\n        return html;\n    }\n\n    private static fillCells(r: number, c: number) {\n        jQuery('.trumbowyg-dropdown-insertTable.trumbowyg-dropdown button').removeClass('active');\n\n        var i: number = 1;\n        var j: number = 1;\n        for (; i <= r; i++) {\n            for (j = 1; j <= c; j++) {\n                // console.log(TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j]);\n                TrumbowygInsertTablePlugin.elementsCache['r' + i + '_c' + j].addClass('active');\n            }\n        }\n    }\n\n    private static buildDropdown(func: any, trumbowyg: any) {\n        var dropdown: string[] = [];\n\n        var i: number = 1;\n        var j: number = 1;\n        for (; i <= 10; i++) {\n            for (j = 1; j <= 10; j++) {\n                var btn: string = 'insertTable_r' + i + '_c' + j + '_' + func;\n                // trumbowyg.addBtnDef()\n                // console.log('trumbowyg', trumbowyg);\n                trumbowyg.addBtnDef(btn, {\n                    forceCss: true,\n                    fn: function (params: any) {\n                        var html = TrumbowygInsertTablePlugin.buildTable(params.r, params.c).join('');\n                        // console.info('HTML', params, t, buildTable(params.r, params.c).join(''), html);\n\n                        trumbowyg.restoreRange();\n                        trumbowyg.syncCode();\n\n                        TrumbowygInsertTablePlugin.editor.insertHtml(trumbowyg, html);\n                    },\n                    text: ' ',\n                    param: {\n                        r: i,\n                        c: j\n                    }\n                });\n                dropdown.push(btn);\n            }\n        }\n\n        return dropdown;\n    }\n}\n","import {Directive, Input, Output, EventEmitter, ElementRef, OnInit, OnChanges}         from '@angular/core';\n\ndeclare var jQuery: any;\n\nexport class TrumbowygSelectImagesPlugin {\n    public static editorImages: any[] = [];\n\n    public static editor: any;\n    public static lang: string;\n    public static imagesExtensions: string[] = ['jpg', 'png', 'jpeg', 'bmp', 'gif', 'svg'];\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectImagesPlugin.editor = editor;\n        TrumbowygSelectImagesPlugin.lang = lang;\n\n        // console.log('TrumbowygSelectImagesPlugin init', editor);\n\n        editor.plugins.selectImage = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectImage = trumbowyg.o.plugins.selectImage || {};\n                // console.log('selectImage trumbowyg', trumbowyg);\n                trumbowyg.addBtnDef('selectImage', {\n                    fn: function (params: any) {\n                        // console.log('selectImageCb', params, trumbowyg, editorImages);\n                        TrumbowygSelectImagesPlugin.selectImageCb(params, trumbowyg, TrumbowygSelectImagesPlugin.editorImages);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n    }\n\n    private static selectImageCb(params: any, t: any, editorImages: any[]) {\n        var pfx: string = t.o.prefix;\n        var i: number = 0,\n            l: number = editorImages.length;\n        if (l == 0) {\n            return;\n        }\n\n        var html: string[] = [];\n        var file: any = null;\n        html.push('<div class=\"modal-container\">');\n        html.push('<ul class=\"' + pfx + 'select-images gallery\">');\n        for (; i < l; i++) {\n            html.push('<li class=\"item\" data-i=\"' + i + '\"><label>' +\n                '<img width=\"50px\" src=\"' + editorImages[i].url + '\"/>' + //editorImages[i].name +\n                '</label></li>'\n            );\n        }\n        html.push('</ul>');\n        html.push('</div>');\n\n        var selectedImageIndex: number = null;\n        var $modal = t.openModal(TrumbowygSelectImagesPlugin.editor.langs[TrumbowygSelectImagesPlugin.lang].attachedImages, html.join(''))\n            .on('tbwconfirm', function () {\n                t.restoreRange();\n                t.syncCode();\n\n                if (selectedImageIndex != null) {\n                    var width = editorImages[selectedImageIndex].width || 1024;\n                    t.execCmd('insertImage', editorImages[selectedImageIndex].url);\n                    if (width > 1024) {\n                        jQuery('img[src=\"' + editorImages[selectedImageIndex].url + '\"]:not([alt])', t.$box).attr('width', '1024px');\n                    }\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n\n        jQuery('li.item', $modal).on('click', function () {\n            jQuery('li', $modal).removeClass('active');\n            jQuery(this).addClass('active');\n            selectedImageIndex = jQuery(this).data('i');\n        });\n    };\n\n    public static updateImages(files: any[]) {\n        TrumbowygSelectImagesPlugin.editorImages = [];\n        files.forEach((img: any) => {\n            img.extension = img.extension || img.url.split('.').pop();\n            if (TrumbowygSelectImagesPlugin.imagesExtensions.indexOf(img.extension) != -1) {\n                // if (img.url.substring(0, 8) != '/uploads') {\n                    // img.url = '/uploads' + img.url;\n                // }\n                if (!img.width) {\n                    var imgObj = new Image();\n                    imgObj.setAttribute('data-i', TrumbowygSelectImagesPlugin.editorImages.length + '');\n                    imgObj.onload = function (e) {\n                        if (e.type !== 'error' && (<any>this).width) {\n                            var indx = parseInt((<any>this).getAttribute('data-i'));\n                            TrumbowygSelectImagesPlugin.editorImages[indx].width = (<any>this).width;\n                        }\n                    }\n                    imgObj.src = img.url;\n                    img.width = 1024;\n                }\n                TrumbowygSelectImagesPlugin.editorImages.push(img);\n            }\n        });\n    }\n}\n","import {EventEmitter}         from '@angular/core';\n\ndeclare var jQuery: any;\n\nexport class TrumbowygSelectResourcesPlugin {\n    public static editorResources: any[] = [];\n\n    public static onSearch: EventEmitter<any> = new EventEmitter();\n\n    public static editor: any;\n    public static $modal: any;\n    public static lang: string;\n    public static pfx: string;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectResourcesPlugin.editor = editor;\n        TrumbowygSelectResourcesPlugin.lang = lang;\n        // TrumbowygSelectResourcesPlugin.onSearch = new EventEmitter();\n\n        editor.plugins.selectResources = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectResources = trumbowyg.o.plugins.selectResources || {};\n                trumbowyg.addBtnDef('selectResources', {\n                    fn: function (params: any) {\n                        // console.log('selectImageCb', params, trumbowyg, editorImages);\n                        TrumbowygSelectResourcesPlugin.selectResourcesCb(params, trumbowyg);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n    }\n\n    private static translate(str: string) {\n        return TrumbowygSelectResourcesPlugin.editor.langs[TrumbowygSelectResourcesPlugin.lang][str]\n    }\n\n    private static renderList(pfx: string, html: string[], items: any[]) {\n        items.forEach((resource: any) => {\n            // console.log('resource', resource);\n            html.push('<li class=\"item\">');\n            html.push('<label>');\n            html.push('<input type=\"radio\" name=\"r' + pfx + '\" data-id=\"' + resource.id + '\" ' +\n                'title=\"' + resource.title + '\" data-type=\"' + resource.display_type + '\" value=\"' + resource.id + '\"/>');\n            html.push('<strong>' + resource.title + '</strong>');\n            if (resource.description && resource.description.length > 0) {\n                html.push('<br/><i>' + resource.description + '</i>');\n            }\n            html.push('</label>');\n            html.push('</li>');\n        });\n    }\n\n\n    private static selectResourcesCb(params: any, t: any) {\n        var pfx = TrumbowygSelectResourcesPlugin.pfx = t.o.prefix;\n        //console.log('editorResources', editorResources);\n\n        var html: string[] = [];\n\n        html.push('<div class=\"resources-select modal-container\">');\n        html.push('<div class=\"resources-search cbr-input-control\">');\n        html.push('<label for=\"text\" class=\"cbr-label\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesSearch') +'</label>');\n        html.push('<input class=\"cbr-input cbr-input-default cbr-input-email\" type=\"text\">');\n        html.push('<span class=\"cbr-icon-input cbr-icon-input-primary\">');\n        html.push('<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"');\n        html.push('width=\"20\" height=\"20\" viewBox=\"0 0 451 451\" style=\"enable-background:new 0 0 451 451;\" xml:space=\"preserve\">');\n        html.push('<g>');\n        html.push('<path d=\"M447.05,428l-109.6-109.6c29.4-33.8,47.2-77.9,47.2-126.1C384.65,86.2,298.35,0,192.35,0C86.25,0,0.05,86.3,0.05,192.3');\n        html.push('s86.3,192.3,192.3,192.3c48.2,0,92.3-17.8,126.1-47.2L428.05,447c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4');\n        html.push('C452.25,441.8,452.25,433.2,447.05,428z M26.95,192.3c0-91.2,74.2-165.3,165.3-165.3c91.2,0,165.3,74.2,165.3,165.3');\n        html.push('s-74.1,165.4-165.3,165.4C101.15,357.7,26.95,283.5,26.95,192.3z\"/>');\n        html.push('</g>');\n        html.push('</svg>');\n        html.push('</span>');\n        html.push('</div>');\n        html.push('<ul class=\"cbr2-tabs\" role=\"tablist\">');\n        html.push('<li role=\"all\" class=\"cbr2-tabs-itemactive\">');\n        html.push('   <a data-type=\"all\"  role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesAll') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"gallery\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"gallery\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesGallery') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"html\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"html\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesHtmlSite') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"video\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"video\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesVideo') + '</a>');\n        html.push('</li>');\n        html.push('<li role=\"audio\" class=\"cbr2-tabs-item\">');\n        html.push('   <a data-type=\"audio\" role=\"tab\">' + TrumbowygSelectResourcesPlugin.translate('selectResourcesAudio') + '</a>');\n        html.push('</li>');\n        html.push('</ul>');\n        html.push('<div class=\"cbr-tab-content\">');\n        html.push('   <div role=\"tabpanel\" class=\"cbr-tab-pane active\">');\n        html.push('   <ul class=\"resources-list list-unstyled\">');\n        TrumbowygSelectResourcesPlugin.renderList(pfx, html, TrumbowygSelectResourcesPlugin.editorResources);\n        html.push('   </ul>');\n        html.push('</div>');\n        html.push('</div>');\n\n        html.push('</div>');\n\n        //console.log('html', html);\n        var $modal = TrumbowygSelectResourcesPlugin.$modal = t.openModal(TrumbowygSelectResourcesPlugin.translate('selectResourcesHeader'), html.join(''))\n            .on('tbwconfirm', function () {\n\n                var selected = jQuery('input:checked', $modal);\n                console.log('selected', selected);\n\n                var val = selected.val();\n                //var i = parseInt(selected.data('i'), 10);\n                var type = selected.data('type');\n\n                t.restoreRange();\n                t.syncCode();\n\n                if (val) {\n                    if (type === 'mp4') {\n                        type = 'video';\n                    }\n                    if (type === 'mp3' || type === 'acc') {\n                        type = 'audio';\n                    }\n\n                    switch (type) {\n                        case 'gallery':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"gallery\" data-ext=\"' + type + '\" data-gallery-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-gallery.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"640px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-gallery/dist/index.html?id=' + val + '\" data-item-id=\"' + val + '\" scrolling=\"no\" marginheight=\"0\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n                            break;\n                        case 'video':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"video\" data-ext=\"' + type + '\" data-video-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-video.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"480px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-video-player/dist/index.html?id=' + val + '\" data-item-id=\"' + val + '\" scrolling=\"no\" marginheight=\"0\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n                            break;\n                        case 'audio':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"audio\" data-ext=\"' + type + '\" data-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-audio.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"65px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-audio-player/dist/index.html?id=' + val + '\" data-item-id=\"' + val + '\" scrolling=\"no\" marginheight=\"0\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n\n                            break;\n                        case 'html':\n                            // TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<img resource-in-resource-render ' +\n                            //     'data-item-id=\"' + val + '\" data-type=\"html\" data-ext=\"' + type + '\" data-src=\"' + val + '\"' +\n                            //     'src=\"/themes/default/assets/img/inline-resource.png\" />');\n                            TrumbowygSelectResourcesPlugin.editor.insertHtml(t, '<iframe resource-in-resource-iframe=\"\" allowfullscreen width=\"100%\" height=\"640px\" frameborder=\"0\" ' +\n                                'src=\"/node_modules/collaborator-html-player/dist/index.html?id=' + val + '\" scrolling=\"no\" marginheight=\"0\" data-item-id=\"' + val + '\" ' +\n                                'class=\"no-border embed-responsive-item\"></iframe>');\n                            break;\n                    }\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n\n        jQuery('.cbr2-tabs a', $modal).off('click').on('click', function (e: any) {\n            e.preventDefault();\n\n            jQuery('.cbr2-tabs-item', $modal).removeClass('cbr-tabs-active');\n            jQuery(this).parent().addClass('cbr-tabs-active');\n\n            TrumbowygSelectResourcesPlugin.onSearch.emit({\n                type: jQuery(this).attr('data-type') || 'all',\n                title: jQuery('.cbr-input', $modal).val()\n            });\n        });\n\n        jQuery('.cbr-icon-input', $modal).off('click').on('click', function () {\n            TrumbowygSelectResourcesPlugin.onSearch.emit({\n                type: jQuery(this).attr('data-type') || 'all',\n                title: jQuery('.cbr-input', $modal).val()\n            });\n        });\n    }\n\n    public static updateResources(editorResources: any[]) {\n        TrumbowygSelectResourcesPlugin.editorResources = editorResources;\n        //\n        jQuery('.resources-list', TrumbowygSelectResourcesPlugin.$modal).empty();\n        var lhtml: string[] = [];\n        TrumbowygSelectResourcesPlugin.renderList(TrumbowygSelectResourcesPlugin.pfx, lhtml, editorResources);\n        jQuery('.resources-list', TrumbowygSelectResourcesPlugin.$modal).append(lhtml.join(''));\n    }\n}\n","// import {EventEmitter}         from '@angular/core';\n\ndeclare var jQuery: any;\n\nconst DEFAULT_ICON = 'themes/default/assets/img/t-icon.png';\n\nexport class TrumbowygSelectTemplatesPlugin {\n    public static templates: any[] = [];\n    public static allTemplates: any = {};\n\n    public static editor: any;\n    public static lang: string;\n\n    public static init(editor: any, lang: string) {\n        TrumbowygSelectTemplatesPlugin.editor = editor;\n        TrumbowygSelectTemplatesPlugin.lang = lang;\n\n        //console.log('init', editor, editor.langs, lang, editor.langs[lang].selectTemplatesNoData);\n\n        //TrumbowygSelectResourcesPlugin.onSearch = new EventEmitter();\n\n        editor.plugins.selectTemplates = {\n            init: function (trumbowyg: any) {\n                trumbowyg.o.plugins.selectTemplates = trumbowyg.o.plugins.selectTemplates || {};\n                trumbowyg.addBtnDef('selectTemplates', {\n                    fn: function (params: any) {\n                        // console.log('selectImageCb', params, trumbowyg, editorImages);\n                        TrumbowygSelectTemplatesPlugin.selectTemplatesCb(params, trumbowyg);\n                    }\n                });\n            },\n            tag: 'img'\n        }\n\n\n        TrumbowygSelectTemplatesPlugin.templates.push({\n            id: 'tab-no-data',\n            label: editor.langs[lang].selectTemplatesNoData,\n            elements: []\n        });\n        TrumbowygSelectTemplatesPlugin.allTemplates['template-no-data'] =\n            '<div>' + editor.langs[lang].selectTemplatesNoData + '</div>';\n    }\n\n    private static selectTemplatesCb(params: any, t: any) {\n        var pfx: string = t.o.prefix;\n        //console.log('editorResources', editorResources);\n\n        var html: string[] = [];\n\n        html.push('<div class=\"modal-container templates-select\">');\n        html.push('<ul class=\"cbr2-tabs\" role=\"tablist\">');\n        TrumbowygSelectTemplatesPlugin.templates.forEach((templateSet, i) => {\n            html.push('<li role=\"' + templateSet.id + '\" class=\"cbr2-tabs-item ' + (i == 0 ? 'active' : '') + '\">');\n            html.push('   <a data-tab=\"' + templateSet.id + '\"  role=\"tab\" data-toggle=\"tab\">' + templateSet.label + '</a>');\n            html.push('</li>');\n        });\n\n        html.push('</ul>');\n        html.push('<div class=\"cbr-tab-content\">');\n\n\n        TrumbowygSelectTemplatesPlugin.templates.forEach((templateSet, i) => {\n            html.push('   <div role=\"tabpanel\" id=\"' + templateSet.id + '\" class=\"cbr-tab-pane ' + (i == 0 ? 'active' : '') + '\">');\n            html.push('   <ul class=\"templates-list template-gallery list-unstyled\">');\n            templateSet.elements.forEach((template: any, j: number) => {\n                template.icon = template.icon || DEFAULT_ICON;\n                html.push('   <li title=\"' + template.description + '\" class=\"item\"><label>' +\n                    '<img src=\"' + template.icon + '\" class=\"select-template-icon\"><input type=\"radio\" value=\"' + template.id + '\" name=\"template\">' +\n                    '<span class=\"title\"> ' + template.title + '</span>' +\n                    '<span class=\"description\"> ' + template.description + '</span>' +\n                    '</label></li>');\n            });\n            html.push('   </ul>');\n            html.push('   </div>');\n        });\n\n        html.push('</div>');\n        html.push('</div>');\n\n\n        //console.log('html', html);\n        var $modal = t.openModal(TrumbowygSelectTemplatesPlugin.editor.langs[TrumbowygSelectTemplatesPlugin.lang].selectTemplatesHeader, html.join(''))\n            .on('tbwconfirm', function () {\n                var selected = jQuery('input:checked', $modal);\n                var val = selected.val();\n                // console.log(val, allTemplates[val]);\n                // jQuery(this).off(pfx + 'confirm');\n\n                t.restoreRange();\n                t.syncCode();\n\n                if (val) {\n                    TrumbowygSelectTemplatesPlugin.editor.insertHtml(t, TrumbowygSelectTemplatesPlugin.allTemplates[val]);\n                }\n\n                setTimeout(function () {\n                    t.closeModal();\n                }, 250);\n            })\n            .on('tbwcancel', function () {\n                t.restoreRange();\n                t.closeModal();\n            });\n        $modal.addClass('big');\n\n        jQuery('.cbr2-tabs a', $modal).off('click').on('click', function (e: any) {\n            e.preventDefault();\n\n            jQuery('.cbr2-tabs-item', $modal).removeClass('cbr-tabs-active');\n            jQuery(this).parent().addClass('cbr-tabs-active');\n\n            //    console.log('O_O', $(this).attr('data-tab'));\n            jQuery('.cbr-tab-content .cbr-tab-pane', $modal).removeClass('active');\n            jQuery('#' + jQuery(this).attr('data-tab')).addClass('active');\n        });\n        jQuery('.template-gallery li label', $modal).off('click').on('click', function (e: any) {\n            //console.log('O_O', e, $(this));\n            jQuery('.template-gallery li', $modal).removeClass('active');\n            jQuery(this).parent().addClass('active');\n        });\n    }\n\n    public static setTemplates(templates: any[], allTemplates: any) {\n        TrumbowygSelectTemplatesPlugin.templates = templates;\n        TrumbowygSelectTemplatesPlugin.allTemplates = allTemplates;\n    }\n}\n","import {\n    Directive,\n    Input,\n    forwardRef,\n    Output,\n    EventEmitter,\n    ElementRef,\n    OnInit,\n    OnDestroy,\n    OnChanges,\n    SimpleChanges, Renderer2\n} from '@angular/core';\nimport {HttpHeaders, HttpClient} from '@angular/common/http';\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR, NG_VALIDATORS, FormControl} from '@angular/forms';\n\nimport 'rxjs/add/operator/toPromise';\n\nimport {TrumbowygTidyPlugin} from './tidy';\nimport {TrumbowygFontSizePlugin} from './font-size';\nimport {TrumbowygFontsPlugin} from './fonts';\nimport {TrumbowygSelectStylesPlugin} from './select-styles';\nimport {TrumbowygInsertLeadPlugin} from './insert-lead';\nimport {TrumbowygInsertMediaEmbedPlugin} from './insert-media-embed';\nimport {TrumbowygInsertTablePlugin} from './insert-table';\nimport {TrumbowygSelectImagesPlugin} from './select-images';\nimport {TrumbowygSelectResourcesPlugin} from './select-resources';\nimport {TrumbowygSelectTemplatesPlugin} from './select-templates';\n\nconst LEGACY_BOOTSTRAP_ID = 'legacy-bootstrap-styles';\n\ndeclare var jQuery: any;\n\n@Directive({\n    selector: '[trumbowyg-editor]',\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TrumbowygEditor),\n            multi: true\n        },\n        {\n            provide: NG_VALIDATORS,\n            useExisting: forwardRef(() => TrumbowygEditor),\n            multi: true\n        }\n    ]\n})\nexport class TrumbowygEditor implements ControlValueAccessor, OnInit, OnChanges, OnDestroy {\n    public static modes: any = {};\n    public static langs: any = {};\n    public static inited: boolean = false;\n    public static localImageRegexp: RegExp = /src\\=\\\"data\\:image\\/(.*)\\\"/gi;\n\n    @Input('has-auto-save') hasAutoSave: boolean = false;\n    @Input('auto-save-key') autoSaveKey: string = '';\n    @Input('last-update') lastUpdate: number = 0;\n    @Input() addBtns: any = [];\n    @Input() mode: string;\n    @Input() lang: string;\n    @Input() base64Image: any;\n\n    private _name: string;\n    private _value: string;\n\n    private _required: boolean = false;\n\n    @Output() base64ImageInserted: any = new EventEmitter();\n\n    public onInit: any = new EventEmitter();\n\n    private element: any;\n\n    private _autoSaveTimer: any = null;\n    private _autoSaved: any = null;\n\n    constructor(private el: ElementRef,\n                private render: Renderer2,\n                private http: HttpClient) {\n        this._required = this.el.nativeElement.hasAttribute('required');\n        this._name = this.el.nativeElement.getAttribute('name');\n        // console.log('el', this._name, this._required);\n    }\n\n    validate(c: FormControl) {\n        if (!this._required) {\n            return null;\n        }\n\n        if (c.value && c.value.length > 0) {\n            return null;\n        }\n\n        // console.log('TrumbowygEditor NG_VALIDATORS', this._name, c.value, 'invalid');\n\n        return {\n            required: true\n        };\n    }\n\n    propagateChange = (_: any) => {\n    };\n\n    registerOnChange(fn: any) {\n        this.propagateChange = fn;\n    }\n\n    registerOnTouched() {\n        // console.log('registerOnTouched');\n    }\n\n    onChange(value: any) {\n        // console.log('onChange', this._value, value);\n        this._value = value;\n\n        if (this.hasAutoSave) {\n            this._autoSave();\n        }\n    }\n\n    private _autoSave() {\n        clearTimeout(this._autoSaveTimer);\n        this._autoSaveTimer = setTimeout(() => {\n            this._saveToServer();\n        }, 500);\n    }\n\n    private _saveToServer() {\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/json',\n            'If-Modified-Since': 'Mon, 26 Jul 1997 05:00:00 GMT',//no cache\n            'Cache-Control': 'no-cache',//no cache\n            'Pragma': 'no-cache'//no cache\n        });\n\n        this.http.post(TrumbowygTidyPlugin.editor.autoSaveUrl + '?action=auto-save', JSON.stringify({\n            key: this.autoSaveKey,\n            content: this._value\n        }), {\n            headers: headers\n        }).toPromise()\n            .then((res: any) => {\n                // console.log('_autoSave res', res.json());\n            });\n    }\n\n    private _checkAutoSave() {\n        this.http.get(TrumbowygTidyPlugin.editor.autoSaveUrl +\n            '?action=check-auto-save&key=' + this.autoSaveKey).toPromise()\n            .then((res: any) => {\n                this._autoSaved = res;\n                // console.log('_checkAutoSave res', this._autoSaved, this.lastUpdate);\n\n                if (this._autoSaved && parseInt(this._autoSaved.date, 10) > this.lastUpdate) {\n                    this._buildAutoSaveToolbar();\n                    // console.log('_hasAutoSave');\n                }\n            });\n    }\n\n    private _buildAutoSaveToolbar() {\n        this.element.data('trumbowyg').$box.append('<div class=\"trumbowyg-auto-save\">' +\n            '<span class=\"title\">' + TrumbowygEditor.langs[this.lang].hasAutoSavedMsg + '</span>' +\n            '<span class=\"buttons\">' +\n            '<button type=\"button\" class=\"button-sm-default\">' + TrumbowygEditor.langs[this.lang].autoSaveCancel + '</button>' +\n            '<button type=\"button\" class=\"button-sm-success\">' + TrumbowygEditor.langs[this.lang].autoSaveRestore + '</button>' +\n            '</span>' +\n            '</div>');\n\n        setTimeout(() => {\n            jQuery('.trumbowyg-auto-save .button-sm-default', this.element.data('trumbowyg').$box)\n                .on('click', (e: any) => {\n                    // console.log('cancel');\n                    e.target.innerHTML = '...';\n                    this.clearAutoSaved();\n                });\n\n            jQuery('.trumbowyg-auto-save .button-sm-success', this.element.data('trumbowyg').$box)\n                .on('click', (e: any) => {\n                    // console.log('restore');\n                    e.target.innerHTML = '...';\n                    this.restoreAutoSave();\n                    jQuery('.trumbowyg-auto-save').hide();\n                });\n        }, 200);\n    }\n\n    public clearAutoSaved() {\n        this.http.get(TrumbowygTidyPlugin.editor.autoSaveUrl +\n            '?action=clear-auto-save&key=' + this.autoSaveKey).toPromise()\n            .then((res: any) => {\n                // console.log('_checkAutoSave res', res.json());\n                this._autoSaved = null;\n                jQuery('.trumbowyg-auto-save').hide();\n            });\n    }\n\n    public restoreAutoSave() {\n        if (this._autoSaved) {\n            this._value = this._autoSaved.content;\n            this.element.trumbowyg('html', this._value);\n            this.propagateChange(this._value);\n            this.lastUpdate = parseInt(this._autoSaved.date, 10);\n        }\n    }\n\n    writeValue(value: any) {\n        // console.log('writeValue', this._name, value);\n\n        if (value != null) {\n            this._value = value;\n\n            // if (this._value.length == 0 && (/webkit/i).test(navigator.userAgent)) {\n            //     this.element.trumbowyg('html', '<p></p>');\n            // } else {\n            this.element.trumbowyg('html', this._value);\n            // }\n        }\n    }\n\n    private init(lang: string) {\n        TrumbowygEditor.inited = true;\n// console.log('init', lang);\n// console.log('TrumbowygEditor.langs', TrumbowygEditor.langs);\n        if (TrumbowygEditor.langs) {\n            jQuery.trumbowyg.langs = TrumbowygEditor.langs;\n        }\n\n        jQuery.trumbowyg.svgPath = (<any>window).TrumbowygEditorSvgPath || '/bower_components/trumbowyg/dist/ui/icons.svg';\n        jQuery.trumbowyg.tidyUrl = '/api/rest.php/trumbowyg?action=tidy';\n        jQuery.trumbowyg.autoSaveUrl = '/api/rest.php/trumbowyg';\n\n        jQuery.trumbowyg.insertHtml = function (t: any, html: string) {\n            try {\n                try {\n                    // <= IE10\n                    t.doc.selection.createRange().pasteHTML(html);\n                } catch (err) {\n                    // IE 11\n                    var el = document.createElement(\"div\");\n                    el.innerHTML = html;\n                    var frag: any = document.createDocumentFragment(),\n                        node: any,\n                        lastNode: any;\n                    while ((node = el.firstChild)) {\n                        lastNode = frag.appendChild(node);\n                    }\n                    var range = t.doc.getSelection().getRangeAt(0);\n                    range.deleteContents();\n                    range.insertNode(frag);\n                }\n            } catch (err) {\n                // Not IE\n                t.execCmd('insertHTML', html);\n            }\n            t.syncCode();\n            t.$c.trigger('tbwchange');\n        }\n\n        var btnsGrps = {\n            design: ['bold', 'italic', 'underline', 'strikethrough'],\n            semantic: ['strong', 'em', 'del'],\n            justify: ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'],\n            lists: ['unorderedList', 'orderedList']\n        };\n\n        TrumbowygTidyPlugin.init(jQuery.trumbowyg, lang, this.http);\n        TrumbowygFontSizePlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygFontsPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygInsertLeadPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectStylesPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygInsertTablePlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygInsertMediaEmbedPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectImagesPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectResourcesPlugin.init(jQuery.trumbowyg, lang);\n        TrumbowygSelectTemplatesPlugin.init(jQuery.trumbowyg, lang);\n\n        //console.trace();\n        //console.log('init', jQuery.trumbowyg);\n\n\n        TrumbowygEditor.modes = {\n            inline: [\n                'removeformat',\n                '|',\n                btnsGrps.design, '|',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                'insertMediaEmbed',\n                'selectImage'\n            ],\n            simple: [\n                'removeformat',\n                '|',\n                btnsGrps.design, '|',\n                'fontName',\n                'fontSize',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'selectImage',\n                'horizontalRule',\n                'fullscreen'\n            ],\n            noImage: [\n                'viewHTML',\n                'removeformat',\n                '|',\n                btnsGrps.design,\n                '|',\n                'formatting',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'horizontalRule',\n                'fullscreen'\n            ],\n            extend: [\n                'viewHTML',\n                'removeformat',\n                '|',\n                btnsGrps.design,\n                '|',\n                'formatting',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'selectImage',\n                'selectTemplates',\n                'insertTable',\n                'horizontalRule',\n                'fullscreen'\n            ],\n            full: [\n                'viewHTML',\n                'removeformat',\n                '|',\n                btnsGrps.design,\n                'selectStyles',\n                '|',\n                'formatting',\n                'fontName',\n                'fontSize',\n                'foreColor',\n                'backColor',\n                '|',\n                btnsGrps.justify,\n                '|',\n                btnsGrps.lists,\n                '|',\n                'link',\n                'insertMediaEmbed',\n                'selectImage',\n                'selectResources',\n                'selectTemplates',\n                'insertTable',\n                'horizontalRule',\n                'fullscreen'\n            ]\n        };\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (this.base64Image) {\n            //console.log('ngOnChanges base64Image', this.base64Image);\n            var el = jQuery('<div>' + this.element.trumbowyg('html') + '</div>');\n            el.find('#' + this.base64Image.uid).attr('src', this.base64Image.file);\n            this.base64Image = null;\n            this.element.trumbowyg('html', el.html());\n        }\n    }\n\n    private detectBase64Insert(html: string) {\n        //console.log('detectBase64Insert', html);\n        if (TrumbowygEditor.localImageRegexp.test(html)) {\n            var images: any[] = [];\n\n            var el = jQuery('<div>' + html + '</div>');\n            var uid: string;\n            el.find('img[src^=\"data:image\"]').each(function () {\n                if (!jQuery(this).attr('id')) {\n                    uid = Math.random().toString(36).substring(2, 9);\n                    jQuery(this).attr('id', uid);\n                    images.push({\n                        uid: uid,\n                        src: this.src\n                    });\n                }\n            });\n            this.element.trumbowyg('html', el.html());\n            //console.log('images', images);\n            images.forEach(image => {\n                this.base64ImageInserted.emit(image);\n            });\n            return true;\n        }\n        return false;\n    }\n\n    ngOnInit() {\n        //console.log('TrumbowygEditor ngOnInit');\n        //console.log('TrumbowygEditor langs', TrumbowygEditor.langs);\n        this.lang = this.lang || 'en';\n\n        this.init(this.lang);\n        this.onInit.emit();\n\n        this.mode = this.mode || 'simple';\n        this.element = jQuery(this.el.nativeElement);\n\n        var tmpBtns = TrumbowygEditor.modes[this.mode];\n        this.addBtns = this.addBtns || null;\n\n        let addElement = 0;\n        if (this.mode == 'extend' || this.mode == 'full') {\n            if (!document.getElementById(LEGACY_BOOTSTRAP_ID)) {\n                let linkContainer = document.createElement(\"LINK\");\n                this.render.setAttribute(linkContainer, 'id', LEGACY_BOOTSTRAP_ID);\n                this.render.setAttribute(linkContainer, 'rel', 'stylesheet');\n                this.render.setAttribute(linkContainer, 'href', '/node_modules/ng2-trumbowyg/assets/modified-bootstrap.css');\n                document.body.appendChild(linkContainer);\n            }\n        }\n        if (this.addBtns && this.mode == 'extend') {\n            console.log('TrumbowygEditor addBtns', this.addBtns);\n            this.addBtns.forEach((value: any) => {\n                if (value == 'selectStyles') {\n                    let elemIndex = TrumbowygEditor.modes['full'].indexOf(value);\n                    tmpBtns.splice(elemIndex, 0, value);\n                    addElement++;\n                }\n\n                if (value == 'selectResources') {\n                    let elemIndex = TrumbowygEditor.modes['full'].indexOf(value);\n                    let countPreviousElements = 1;\n                    tmpBtns.splice(elemIndex - countPreviousElements + addElement, 0, value);\n                }\n            });\n        }\n\n        this.element.trumbowyg('destroy');\n        this.element.trumbowyg({\n            btns: tmpBtns,\n            lang: this.lang,\n            mobile: true,\n            semantic: false,\n            autogrow: this.mode == 'inline',\n            tablet: true\n        })\n            .on('tbwpaste', () => {\n                var html: string = this.element.trumbowyg('html');\n                //console.log('tbwpaste', html);\n                if (!this.detectBase64Insert(html)) {\n                    this.propagateChange(html);\n                    this.onChange(html);\n                }\n                //console.log('tbwpaste', html);\n                //console.log('self.ngModelChange', self.ngModelChange);\n            })\n            .on('tbwchange', () => {\n                var html: string = this.element.trumbowyg('html');\n                //console.log('tbwchange', html);\n                if (!this.detectBase64Insert(html)) {\n                    this.propagateChange(html);\n                    this.onChange(html);\n                }\n                //console.log('tbwchange', html);\n                //console.log('self.ngModelChange', self.ngModelChange);\n            })\n            .on('tbwinit', (e: any) => {\n                let t: any = this.element.data('trumbowyg');\n                // console.log('tbwinit', e, t, this.element);\n                if (t) {\n                    t.$box.addClass('trumbowyg-' + this.mode);\n                    t.$ed.addClass('page-container');\n                    t.$ed.addClass('legacy-bootstrap');\n                    // console.log('tbwinit', e, t, t.$ed, t.$box);\n                    if (t.$box.width() >= 1200) {\n                        t.$ed.addClass('bordered');\n                    }\n                }\n            });\n\n        setTimeout(() => {\n            // console.log('hasAutoSave', this.hasAutoSave);\n            if (this.hasAutoSave) {\n                this._checkAutoSave();\n            }\n        }, 500);\n    }\n\n    ngOnDestroy() {\n        this.element.trumbowyg('destroy');\n    }\n}\n","import {NgModule} from '@angular/core';\nimport {HttpClientModule} from '@angular/common/http';\n\nimport {TrumbowygEditor} from './editor';\n\n@NgModule({\n    imports: [\n        HttpClientModule\n    ],\n    declarations: [\n        TrumbowygEditor\n    ],\n    exports: [\n        TrumbowygEditor\n    ]\n})\nexport class TrumbowygEditorModule {\n}\n"]}